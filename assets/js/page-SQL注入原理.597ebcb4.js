(window.webpackJsonp=window.webpackJsonp||[]).push([[121],{1320:function(v,_,s){"use strict";s.r(_);var t=s(1),l=Object(t.a)({},(function(){var v=this,_=v.$createElement,t=v._self._c||_;return t("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[t("h1",{attrs:{id:"sql-注入原理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sql-注入原理"}},[v._v("#")]),v._v(" SQL 注入原理")]),v._v(" "),t("h2",{attrs:{id:"什么是-sql-注入"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#什么是-sql-注入"}},[v._v("#")]),v._v(" 什么是 SQL 注入")]),v._v(" "),t("ul",[t("li",[t("p",[v._v("由于用户不可控输入，攻击者可以任意的输入恶意的 SQL 语句，使原始的查询语句的语义发生改变")])]),v._v(" "),t("li",[t("p",[v._v("在"),t("strong",[v._v("数据交互")]),v._v("时，"),t("strong",[v._v("前端的数据传入到后台处理")]),v._v("时，"),t("strong",[v._v("没有做严格的判断")]),v._v("，导致其传入的“数据”"),t("strong",[v._v("拼接")]),v._v("到 SQL 语句中后，"),t("strong",[v._v("被当作 SQL 语句的一部分执行")])])])]),v._v(" "),t("p",[t("img",{attrs:{src:s(778),alt:"sql"}})]),v._v(" "),t("p",[t("strong",[v._v("注入漏洞经常出现的位置")]),v._v(":")]),v._v(" "),t("ul",[t("li",[v._v("常发生于用户和服务交互处（增删改查操作），Ajax，接口等等")])]),v._v(" "),t("p",[t("strong",[v._v("实现注入攻击的两个关键条件(重点)")]),v._v(":")]),v._v(" "),t("ul",[t("li",[v._v("第一个：用户能控制输入——用户能控制输入变量")]),v._v(" "),t("li",[v._v("第二个：原本程序要执行的代码，"),t("strong",[v._v("拼接")]),v._v("了用户输入的数据（正是拼接的这个过程导致了代码的注入）")])]),v._v(" "),t("h2",{attrs:{id:"sql注入危害"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sql注入危害"}},[v._v("#")]),v._v(" SQL注入危害")]),v._v(" "),t("p",[v._v("攻击者利用 SQL 注入漏洞，带来的风险有很多，例如：")]),v._v(" "),t("ul",[t("li",[v._v("数据库被拖库")]),v._v(" "),t("li",[v._v("管理员和重要人员信息泄露")]),v._v(" "),t("li",[v._v("甚至还能通过 SQL 注入漏洞直 接获取 webshell 或者服务器系统权限等等")])]),v._v(" "),t("p",[t("strong",[v._v("具体危害如下")]),v._v("：")]),v._v(" "),t("ul",[t("li",[v._v("绕过登录验证：使用万能密码登录网站后台等")]),v._v(" "),t("li",[v._v("获取敏感数据：获取网站管理员帐号、密码等")]),v._v(" "),t("li",[v._v("文件系统操作：列目录，读取、写入文件等")]),v._v(" "),t("li",[v._v("注册表操作：读取、写入、删除注册表等")]),v._v(" "),t("li",[v._v("执行系统命令：远程执行命令")])]),v._v(" "),t("h2",{attrs:{id:"sql注入防御"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sql注入防御"}},[v._v("#")]),v._v(" SQL注入防御")]),v._v(" "),t("ul",[t("li",[v._v("对传进 SQL 语句里面的变量进行过滤，不允许危险字符传入")]),v._v(" "),t("li",[v._v("预编译参数化查询 (提前编译 SQL 语句，将所有的用户输入都当做『数据』，而非『语法』)在设计与数据库连接并访问数据时，在需要填入数值或数据的地方，使用参数（Parameter）来给值")]),v._v(" "),t("li",[v._v('目前有很多 ORM 框架会自动使用参数化解决注入问题,但其也提供了"拼接"的方式,所以使用时需要慎重')]),v._v(" "),t("li",[t("strong",[v._v("采用黑名单、白名单")]),v._v("等形式对用户提交的信息进行过滤，一旦发现用户参数中出现敏感的词或者内容，则将其删除，使得执行失败")]),v._v(" "),t("li",[v._v("安全设计遵循“数据与代码分离”原则")]),v._v(" "),t("li",[v._v("使用 WAF(web 应用防护墙)等安全产品")])]),v._v(" "),t("h3",{attrs:{id:"如何发现被-sql-注入攻击"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#如何发现被-sql-注入攻击"}},[v._v("#")]),v._v(" 如何发现被 SQL 注入攻击")]),v._v(" "),t("blockquote",[t("p",[v._v("日志监控---\x3e蜜罐数据---\x3e异常报警")])]),v._v(" "),t("p",[t("strong",[v._v("监测方面")])]),v._v(" "),t("p",[v._v("目前大多都是：日志监控 + WAF")]),v._v(" "),t("ul",[t("li",[v._v("日志推荐走数据库日志，越是离资源操作 近的地方，越是容易做到真正的安全")]),v._v(" "),t("li",[v._v("数据库日志容易解析，语法出错的、语法读 Info表的，都明确是黑客嘛，还能帮我们发现 SQL 注入点")])]),v._v(" "),t("p",[t("strong",[v._v("蜜罐方面")])]),v._v(" "),t("ul",[t("li",[v._v("数据库里可放置一些蜜罐数据的帐号和密码，假如这有一个服务，可以先从日志入手，发现请求恶意异常时，自动转发蜜罐")]),v._v(" "),t("li",[v._v("比如用户表里，前几十行里，做些用户名和密码 进行，实际上没有人用，一旦被登录，立马报警")])]),v._v(" "),t("h2",{attrs:{id:"sql注入分类"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sql注入分类"}},[v._v("#")]),v._v(" SQL注入分类")]),v._v(" "),t("h3",{attrs:{id:"按照数据类型分类"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#按照数据类型分类"}},[v._v("#")]),v._v(" 按照数据类型分类")]),v._v(" "),t("ul",[t("li",[t("p",[v._v("数字型")])]),v._v(" "),t("li",[t("p",[v._v("字符型")])])]),v._v(" "),t("h3",{attrs:{id:"按照注入点分类-哪些地方存在-sql注入"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#按照注入点分类-哪些地方存在-sql注入"}},[v._v("#")]),v._v(" 按照注入点分类(哪些地方存在 SQL注入)")]),v._v(" "),t("ul",[t("li",[t("p",[v._v("GET 型（注入点在 UR）")])]),v._v(" "),t("li",[t("p",[v._v("POST 型（注入点在表单输入框中，且数据提交方式是 POST，如登录框、注册框）")])]),v._v(" "),t("li",[t("p",[v._v("COOKIE 型（注入点在 cookie中）")])]),v._v(" "),t("li",[t("p",[v._v("Header 型(注入点在头部)")])]),v._v(" "),t("li",[t("p",[v._v("其他(请求报文中只要能够被后端脚本引擎接受的数据均可 SQ L注入)")])])]),v._v(" "),t("h3",{attrs:{id:"按照数据获取的方式分类"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#按照数据获取的方式分类"}},[v._v("#")]),v._v(" 按照数据获取的方式分类")]),v._v(" "),t("ul",[t("li",[t("p",[v._v("回显注入--联合查询")])]),v._v(" "),t("li",[t("p",[v._v("报错注入--报错回显(extractvalue(), updatexml(), floor())")])]),v._v(" "),t("li",[t("p",[v._v("盲注（没有错误回显）")]),v._v(" "),t("ul",[t("li",[v._v("bool 盲注--逻辑语句判断查询出的字符")]),v._v(" "),t("li",[v._v("时间盲注--利用页面演示情况判断数据库中的数据")])])])]),v._v(" "),t("p",[t("strong",[v._v("注意:")])]),v._v(" "),t("p",[t("strong",[t("code",[v._v("盲注，time盲注，报错注入，union注入")])]),v._v(",这些注入漏洞出现频率较高")]),v._v(" "),t("p",[t("strong",[t("code",[v._v("在不影响正常服务的情况下，拼接查询算最高危害的，接下来就是union。")])])]),v._v(" "),t("p",[t("strong",[t("code",[v._v("比较好检测的注入有：盲注，time盲注，报错注入等")])])]),v._v(" "),t("h2",{attrs:{id:"sql注入流程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sql注入流程"}},[v._v("#")]),v._v(" SQL注入流程")]),v._v(" "),t("p",[t("img",{attrs:{src:s(779),alt:"sql"}})]),v._v(" "),t("h3",{attrs:{id:"流程细节"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#流程细节"}},[v._v("#")]),v._v(" 流程细节")]),v._v(" "),t("ul",[t("li",[t("p",[v._v("找疑似注入点--找数据输入的地方")])]),v._v(" "),t("li",[t("p",[v._v("判断注入点----找输入点中与数据库有交互的地方")])]),v._v(" "),t("li",[t("p",[v._v("确认注入存在----确认找到于数据库有交互的地方是不是存在sql注入")])]),v._v(" "),t("li",[t("p",[v._v("选择攻击目标----选择攻击后需要达到的目的")])]),v._v(" "),t("li",[t("p",[v._v("根据选择的目标构sql语言")])]),v._v(" "),t("li",[t("p",[v._v("提交sql语言")])]),v._v(" "),t("li",[t("p",[v._v("判断网页响应是否与目标一致")]),v._v(" "),t("ul",[t("li",[v._v("后端语言对输入的 sql 语句有限制，考虑重构sql语句")]),v._v(" "),t("li",[v._v("选择的目标在当前网站不具备成功的条件，考虑重新选择目标")])])]),v._v(" "),t("li",[t("p",[v._v("响应符合预期，则完成注入")])])])])}),[],!1,null,null,null);_.default=l.exports},778:function(v,_,s){v.exports=s.p+"assets/img/sql1.50003de6.png"},779:function(v,_,s){v.exports=s.p+"assets/img/sql2.597cd8be.png"}}]);