(window.webpackJsonp=window.webpackJsonp||[]).push([[216],{1208:function(s,t,a){"use strict";a.r(t);var n=a(1),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"使用-openpyxl-处理新版本-excel"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#使用-openpyxl-处理新版本-excel"}},[s._v("#")]),s._v(" 使用 openpyxl 处理新版本 Excel")]),s._v(" "),n("h2",{attrs:{id:"关于-openpyxl"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#关于-openpyxl"}},[s._v("#")]),s._v(" 关于 openpyxl")]),s._v(" "),n("p",[s._v("openpyxl 是读写新版本 Excel（"),n("code",[s._v(".xlsx")]),s._v("） 的第三方库，是一个比较综合的工具，能够同时读取和修改 Excel 文档。支持的格式有 "),n("code",[s._v(".xlsx")]),s._v("、"),n("code",[s._v(".xlsm")]),s._v("、"),n("code",[s._v(".xltx")]),s._v(" 和 "),n("code",[s._v(".xltm")])]),s._v(" "),n("p",[s._v("安装比较简单，直接用 pip 工具即可，安装命令如下：")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" pip "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" openpyxl\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h2",{attrs:{id:"写入-excel"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#写入-excel"}},[s._v("#")]),s._v(" 写入 Excel")]),s._v(" "),n("p",[s._v("下面是一个使用 openpyxl 写入数据到 Excel 的代码示例，大致逻辑是：遍历源数据，通过指定行号和列号，依次插入 Excel 表格的每个单元格中")]),s._v(" "),n("div",{staticClass:"custom-block warning"},[n("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),n("ul",[n("li",[s._v("Python 中数组的索引是从 0 开始的")]),s._v(" "),n("li",[s._v("而 openpyxl 在指定单元格时索引是从 1 开始的（"),n("code",[s._v("sheet.cell(row, column, value)")]),s._v("）")]),s._v(" "),n("li",[s._v("因此，openpyxl 的首行、首列是 (1, 1) 而不是 (0, 0)")])])]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/usr/bin/env python")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -*- coding: utf-8 -*-")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v('"""\n使用第三方库：pip install openpyxl\n一般用于处理新版本 Excel(.xlsx)\n"""')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" openpyxl\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 数据形如：[['张三', '信息与通信工程', '数值分析', 88]]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("write_excel")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sheet_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" head"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 实例化一个工作薄对象")]),s._v("\n    workbook "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" openpyxl"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 激活一个 Sheet 表（工作表），并为它设置一个 title")]),s._v("\n    sheet "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("active\n    sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("title "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sheet_name\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# data 中添加表头（不需要表头可以不用加）")]),s._v("\n    data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("insert"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("list")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("head"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开始遍历并插入数据")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# row: 行  col: 列")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" row_index"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" row_item "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("enumerate")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" col_index"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" col_item "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("enumerate")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("row_item"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 写入单元格")]),s._v("\n            sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cell"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("row"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("row_index "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" column"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("col_index "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" value"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("col_item"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("save"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" __name__ "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"__main__"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mock 数据")]),s._v("\n    sheet_name "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'成绩'")]),s._v("\n    head "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'姓名'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'专业'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'科目'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'成绩'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    data "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'张三'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'信息与通信工程'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'数值分析'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("88")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'李四'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'物联网工程'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'数字信号处理分析'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("95")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'王华'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'电子与通信工程'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'模糊数学'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("90")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'王欢'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'通信工程'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'机器学习'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("89")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    path "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'student.xlsx'")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 执行方法")]),s._v("\n    write_excel"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sheet_name，head"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br")])]),n("p",[s._v("运行代码，结果会看到生成名为 student.xlsx 的 Excel 文件，打开文件查看如下图所示：")]),s._v(" "),n("div",{staticStyle:{"text-align":"center"}},[n("img",{attrs:{src:a(645),height:"200",alt:"使用 openpyxl 写入数据到 Excel"}})]),s._v(" "),n("p",[s._v("拓展：")]),s._v(" "),n("ul",[n("li",[s._v("在实例化一个工作薄对象时，默认会产生一个 Sheet，默认名字是："),n("code",[s._v('"Sheet"')]),s._v("，激活它后就可使用")])]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[s._v("workbook "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" openpyxl"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsheet "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("active\nsheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("title "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sheet_name\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("ul",[n("li",[s._v("新增第二个 Sheet 并使用")])]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[s._v("sheet_2 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("create_sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("title"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Sheet名"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsheet_2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'F5'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.14")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("ul",[n("li",[s._v("遍历 Sheet 对象")])]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" sheet "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'sheet:'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("ul",[n("li",[s._v("遍历 Sheet 名然后通过名字获取 Sheet 对象")])]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[s._v("sheet_names "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sheet_names\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" sheet_name "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" sheet_names"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    sheet "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sheet_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'sheet:'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h2",{attrs:{id:"读取-excel"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#读取-excel"}},[s._v("#")]),s._v(" 读取 Excel")]),s._v(" "),n("p",[s._v("下面是一个使用 openpyxl 读取 Excel 数据的代码示例，逻辑比较简单：先执行要读取的 Sheet 表，然后逐行遍历，每一行中依次读取每一列（即每个单元格的数据）")]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/usr/bin/env python")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -*- coding: utf-8 -*-")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v('"""\n使用第三方库：pip install openpyxl\n一般用于处理新版本 Excel(.xlsx)\n"""')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" openpyxl\n\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("read_excel")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sheet_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 实例化一个工作薄对象")]),s._v("\n    workbook "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" openpyxl"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("load_workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 获取指定名字的 Sheet 表")]),s._v("\n    sheet "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sheet_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 定义一个数组，存放要输出的数据")]),s._v("\n    result "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sheet.rows 为表格内的每一行数据")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 循环获取表格内的每一行数据")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" row_index"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" row_item "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("enumerate")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rows"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 定义一个空的数组用来存放每一行数据单元格的数据")]),s._v("\n        current_row "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" col_index"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" col_item "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("enumerate")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("row_item"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 获取单元格数据 追加到 return_row")]),s._v("\n            current_row"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("append"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("col_item"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 把每一行数据追加到结果 return_data 中，最后输出")]),s._v("\n        result"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("append"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("current_row"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" result\n\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" __name__ "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"__main__"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mock 数据")]),s._v("\n    sheet_name "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'成绩'")]),s._v("\n    path "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'student.xlsx'")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 执行方法")]),s._v("\n    result "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" read_excel"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sheet_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("result"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br")])]),n("p",[s._v("输出如下结果：")]),s._v(" "),n("div",{staticStyle:{"text-align":"center"}},[n("img",{attrs:{src:a(646),height:"133",alt:"使用 openpyxl 从 Excel 读取数据"}})]),s._v(" "),n("h2",{attrs:{id:"常用读取-api"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#常用读取-api"}},[s._v("#")]),s._v(" 常用读取 API")]),s._v(" "),n("p",[s._v("接下来列举通过 openpyxl 读写 Excel 时常用的 API")]),s._v(" "),n("blockquote",[n("p",[s._v("如无特别标注，以下所有代码中的 "),n("code",[s._v("workbook")]),s._v(" 为工作薄的实例对象，"),n("code",[s._v("sheet")]),s._v(" 为工作表的实力对象")])]),s._v(" "),n("h3",{attrs:{id:"打开-excel-表格并获取表格名称"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#打开-excel-表格并获取表格名称"}},[s._v("#")]),s._v(" 打开 Excel 表格并获取表格名称")]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" openpyxl "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" load_workbook\nworkbook "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" load_workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nworkbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sheetnames\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h3",{attrs:{id:"通过-sheet-名称获取表格"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#通过-sheet-名称获取表格"}},[s._v("#")]),s._v(" 通过 Sheet 名称获取表格")]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" openpyxl "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" load_workbook\nworkbook "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" load_workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nworkbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sheetnames\nsheet "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Sheet1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h3",{attrs:{id:"获取表格的尺寸大小"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#获取表格的尺寸大小"}},[s._v("#")]),s._v(" 获取表格的尺寸大小")]),s._v(" "),n("p",[s._v("这里所说的尺寸大小，指的是 Excel 表格中的数据有几行几列，针对的是不同的 Sheet 而言")]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[s._v("sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("dimensions\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h3",{attrs:{id:"获取最大行、最大列"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#获取最大行、最大列"}},[s._v("#")]),s._v(" 获取最大行、最大列")]),s._v(" "),n("p",[s._v("注意：获取到的最大行与最大列都是基于起始索引 1 计算的")]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[s._v("sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("max_row     "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 最大行")]),s._v("\nsheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("max_column  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 最大列")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h3",{attrs:{id:"获取表格内某个格子的数据"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#获取表格内某个格子的数据"}},[s._v("#")]),s._v(" 获取表格内某个格子的数据")]),s._v(" "),n("ul",[n("li",[n("code",[s._v('sheet["A1"]')]),s._v(" 方式")])]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v('"""\nworkbook.active 打开激活的表格；\nsheet["A1"] 获取A1格子的数据；\ncell.value 获取格子中的值；\n"""')]),s._v("\n\nworkbook "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" load_workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsheet "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("active\n\ncell1 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\ncell2 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"C11"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cell1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" cell2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("ul",[n("li",[n("code",[s._v("sheet.cell(row=, column=)")]),s._v(" 方式，这种方式更简单")])]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[s._v("workbook "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" load_workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsheet "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("active\n\ncell1 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cell"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("row"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("column"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ncell2 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cell"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("row"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("column"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cell1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" cell2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h3",{attrs:{id:"获取某个单元格的行数、列数、坐标"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#获取某个单元格的行数、列数、坐标"}},[s._v("#")]),s._v(" 获取某个单元格的行数、列数、坐标")]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v('"""\n.row 获取某个格子的行数；\n.columns 获取某个格子的列数；\n.corordinate 获取某个格子的坐标；\n"""')]),s._v("\n\nworkbook "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" load_workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsheet "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("active\n\ncell1 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\ncell2 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"C11"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cell1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" cell1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("row"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" cell1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("column"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" cell1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("coordinate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cell2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" cell2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("row"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" cell2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("column"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" cell2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("coordinate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("h3",{attrs:{id:"获取一系列单元格"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#获取一系列单元格"}},[s._v("#")]),s._v(" 获取一系列单元格")]),s._v(" "),n("ul",[n("li",[n("code",[s._v("sheet[]")]),s._v(" 方式")])]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[s._v("workbook "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" load_workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsheet "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("active\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 获取 A1:C2 区域的值")]),s._v("\ncells "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A1:C2"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cells"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" row "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" cells"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" col "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" row"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("col"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# 如果我们只想获取"A列"，或者获取"A-C列"，可以采取如下方式：')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# sheet["A"]    --- 获取 A 列的数据')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# sheet["A:C"]  --- 获取 A,B,C 三列的数据')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sheet[5]      --- 获取第 5 行的数据")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])]),n("ul",[n("li",[n("code",[s._v(".iter_rows()")]),s._v(" 和 "),n("code",[s._v(".iter_cols()")]),s._v(" 方式")])]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[s._v("workbook "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" load_workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsheet "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("active\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 按行获取值")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" row_item "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("iter_rows"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("min_row"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" max_row"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" min_col"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" max_col"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" col_item "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" row_item"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("col_item"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 按列获取值")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" col_item "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("iter_cols"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("min_row"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" max_row"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" min_col"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" max_col"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" row_item "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" col_item"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("row_item"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("ul",[n("li",[n("code",[s._v("sheet.rows")]),s._v(" 获取所有行")])]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[s._v("workbook "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" load_workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsheet "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("active\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" row_item "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rows"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("row_item"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h2",{attrs:{id:"常用写入-api"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#常用写入-api"}},[s._v("#")]),s._v(" 常用写入 API")]),s._v(" "),n("h3",{attrs:{id:"向指定单元格写入数据并保存"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#向指定单元格写入数据并保存"}},[s._v("#")]),s._v(" 向指定单元格写入数据并保存")]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v('"""\n注意：下方代码将"A1"单元格的数据改为了"哈喽"，并另存为"哈喽.xlsx"文件。\n如果我们保存的时候，不修改表名，相当于直接修改源文件。\n"""')]),s._v("\n\nworkbook "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" load_workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsheet "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("active\n\nsheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"哈喽"')]),s._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# 这句代码也可以改为 cell = sheet["A1"] cell.value = "哈喽"')]),s._v("\nworkbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("save"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"哈喽.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("h3",{attrs:{id:"向表格中插入行数据"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#向表格中插入行数据"}},[s._v("#")]),s._v(" 向表格中插入行数据")]),s._v(" "),n("ul",[n("li",[s._v("使用 "),n("code",[s._v(".append()")]),s._v(" 方法：会在表格已有的数据后面，追加新数据（按行插入）；")]),s._v(" "),n("li",[s._v("这个操作很有用，爬虫得到的数据，可以使用该方式保存成 Excel 文件")])]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v('"""\n下方代码会将 data 中的数据逐行追加到原表格数据后面\n"""')]),s._v("\n\nworkbook "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" load_workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsheet "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("active\n\ndata "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"唐僧"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"男"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"180cm"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"孙悟空"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"男"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"188cm"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"猪八戒"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"男"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"175cm"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"沙僧"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"男"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"176cm"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" row "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("append"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("row"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nworkbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("save"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("h3",{attrs:{id:"使用-excel-函数公式-很有用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#使用-excel-函数公式-很有用"}},[s._v("#")]),s._v(" 使用 Excel 函数公式(很有用)")]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v('"""\n这是在 Excel 中输入的公式：\n=IF(RIGHT(C2,2)="cm",C2,SUBSTITUTE(C2,"m","")*100&"cm")\n"""')]),s._v("\n\nworkbook "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" load_workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsheet "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("active\n\nsheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"D1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"标准身高"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" i "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("range")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"D{}"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("format")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'=IF(RIGHT(C{},2)="cm",C{},SUBSTITUTE(C{},"m","")*100&"cm")\'')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("format")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nworkbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("save"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("h3",{attrs:{id:"插入空行和空列"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#插入空行和空列"}},[s._v("#")]),s._v(" 插入空行和空列")]),s._v(" "),n("p",[s._v("使用 "),n("code",[s._v(".insert_cols()")]),s._v(" 和 "),n("code",[s._v(".insert_rows()")]),s._v(" 方法：")]),s._v(" "),n("ul",[n("li",[n("code",[s._v(".insert_cols(idx=数字编号, amount=要插入的列数)")]),s._v("，插入的位置是在 idx 列数的左侧插入")]),s._v(" "),n("li",[n("code",[s._v(".insert_rows(idx=数字编号, amount=要插入的行数)")]),s._v("，插入的位置是在 idx 行数的下方插入")])]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[s._v("workbook "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" load_workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsheet "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("active\n\nsheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("insert_cols"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("idx"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("amount"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("insert_rows"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("idx"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("amount"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nworkbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("save"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h3",{attrs:{id:"删除指定行和列"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#删除指定行和列"}},[s._v("#")]),s._v(" 删除指定行和列")]),s._v(" "),n("p",[s._v("使用 "),n("code",[s._v(".delete_rows()")]),s._v(" 和 "),n("code",[s._v(".delete_cols()")]),s._v(" 方法：")]),s._v(" "),n("ul",[n("li",[n("code",[s._v(".delete_rows(idx=数字编号, amount=要删除的行数)")])]),s._v(" "),n("li",[n("code",[s._v(".delete_cols(idx=数字编号, amount=要删除的列数)")])])]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[s._v("workbook "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" load_workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsheet "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("active\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除第一列，第一行")]),s._v("\nsheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("delete_cols"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("idx"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("delete_rows"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("idx"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nworkbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("save"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("h3",{attrs:{id:"移动指定单元格"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#移动指定单元格"}},[s._v("#")]),s._v(" 移动指定单元格")]),s._v(" "),n("p",[s._v("使用 "),n("code",[s._v('.move_range("数据区域",rows=,cols=)')]),s._v(" 方法：正整数为向下或向右、负整数为向左或向上")]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 向左移动两列，向下移动两行")]),s._v("\nsheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("move_range"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"C1:D4"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" rows"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" cols"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h3",{attrs:{id:"创建新的-sheet-表"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建新的-sheet-表"}},[s._v("#")]),s._v(" 创建新的 Sheet 表")]),s._v(" "),n("p",[s._v("使用 "),n("code",[s._v('.create_sheet("新的Sheet名")')]),s._v(" 方法")]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[s._v("workbook "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" load_workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsheet "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("active\n\nworkbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("create_sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"一个新的Sheet"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sheetnames"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nworkbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("save"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h3",{attrs:{id:"删除指定-sheet-表"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#删除指定-sheet-表"}},[s._v("#")]),s._v(" 删除指定 Sheet 表")]),s._v(" "),n("p",[s._v("使用 "),n("code",[s._v('.remove("Sheet名")')]),s._v(" 方法")]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[s._v("workbook "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" load_workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsheet "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("active\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sheetnames"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这个相当于通过名字来激活指定 Sheet 表，激活状态下，才可以操作")]),s._v("\nsheet "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'一个新的Sheet'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nworkbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("remove"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sheetnames"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nworkbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("save"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("h3",{attrs:{id:"复制一个-sheet-表到另外一份-excel"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#复制一个-sheet-表到另外一份-excel"}},[s._v("#")]),s._v(" 复制一个 Sheet 表到另外一份 Excel")]),s._v(" "),n("p",[s._v("使用 "),n("code",[s._v(".copy_worksheet()")]),s._v(" 方法：复制某个 Excel 表中的 Sheet 表，然后将文件存储到另外一个 Excel 中（追加到最后）")]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[s._v("workbook "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" load_workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test_src.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsheet "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("active\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test_src.xlsx 中有这几个 Sheet 表："')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sheetnames"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nsheet "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'姓名'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  \nworkbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("copy_worksheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nworkbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("save"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test_dst.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("h3",{attrs:{id:"修改-sheet-表的名称"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#修改-sheet-表的名称"}},[s._v("#")]),s._v(" 修改 Sheet 表的名称")]),s._v(" "),n("p",[s._v("使用 "),n("code",[s._v('.title = "新的sheet表名"')])]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[s._v("workbook "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" load_workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsheet "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("active\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nsheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("title "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"我是修改后的sheet名"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h3",{attrs:{id:"创建新的-excel-文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建新的-excel-文件"}},[s._v("#")]),s._v(" 创建新的 Excel 文件")]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" openpyxl "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" Workbook\n\nworkbook "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsheet "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("active\nsheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("title "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"表格1"')]),s._v("\nworkbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("save"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"新建的Excel"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h3",{attrs:{id:"冻结窗口"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#冻结窗口"}},[s._v("#")]),s._v(" 冻结窗口")]),s._v(" "),n("blockquote",[n("p",[s._v("冻结窗口以后，滑动垂直/水平滚动条，该单元格的位置不会改变")])]),s._v(" "),n("p",[s._v("使用 "),n("code",[s._v('.freeze_panes = "单元格"')]),s._v(" 方法：需要确保指定的单元格不在第一行，因为 "),n("code",[s._v("freeze_panes")]),s._v(" 将冻结给定单元格上方的行和左侧的列")]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v('"""\nsheet.freeze_panes = "B1"  # 冻结第一列\nsheet.freeze_panes = "A2"  # 冻结第一行\nsheet.freeze_panes = "B2"  # 同时冻结第一行和第一列\n"""')]),s._v("\n\nworkbook"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("load_workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsheet "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("active\n\nsheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("freeze_panes "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A2"')]),s._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 冻结第一行")]),s._v("\nworkbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("save"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("h3",{attrs:{id:"给表格添加筛选器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#给表格添加筛选器"}},[s._v("#")]),s._v(" 给表格添加筛选器")]),s._v(" "),n("p",[s._v("使用 "),n("code",[s._v("sheet.auto_filter.ref")]),s._v(" 方法")]),s._v(" "),n("ul",[n("li",[n("code",[s._v(".auto_filter.ref = sheet.dimension")]),s._v("：给所有字段添加筛选器")]),s._v(" "),n("li",[n("code",[s._v('.auto_filter.ref = "A1"')]),s._v("：给 A1 这个格子添加筛选器，就是给第一列添加筛选器")])]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[s._v("workbook "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" load_workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsheet "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("active\n\nsheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("auto_filter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ref "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nworkbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("save"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h2",{attrs:{id:"常用格式化-api"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#常用格式化-api"}},[s._v("#")]),s._v(" 常用格式化 API")]),s._v(" "),n("h3",{attrs:{id:"修改字体样式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#修改字体样式"}},[s._v("#")]),s._v(" 修改字体样式")]),s._v(" "),n("ul",[n("li",[n("code",[s._v("Font(name=字体名称, size=字体大小, bold=是否加粗, italic=是否斜体, color=字体颜色)")])])]),s._v(" "),n("p",[s._v("其中，color 是 RGB 的 16 进制表示")]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" openpyxl"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("styles "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" Font\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" openpyxl "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" load_workbook\n\n\nworkbook "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" load_workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsheet "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("active\ncell "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nfont "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Font"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("name"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"微软雅黑"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("size"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("bold"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("italic"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("color"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"FF0000"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ncell"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("font "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" font\nworkbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("save"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"花园.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("h3",{attrs:{id:"获取单元格的字体样式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#获取单元格的字体样式"}},[s._v("#")]),s._v(" 获取单元格的字体样式")]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" openpyxl"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("styles "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" Font\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" openpyxl "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" load_workbook\n\n\nworkbook "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" load_workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsheet "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("active\ncell "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A2"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nfont "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" cell"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("font\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("font"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" font"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("size"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" font"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("bold"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" font"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("italic"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" font"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("color"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h3",{attrs:{id:"设置对齐样式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#设置对齐样式"}},[s._v("#")]),s._v(" 设置对齐样式")]),s._v(" "),n("ul",[n("li",[n("code",[s._v("Alignment(horizontal=水平对齐模式, vertical=垂直对齐模式, text_rotation=旋转角度, wrap_text=是否自动换行)")]),s._v(" "),n("ul",[n("li",[s._v("水平对齐模式：'distributed'，'justify'，'center'，'leftfill'，'centerContinuous'，'right'，'general'")]),s._v(" "),n("li",[s._v("垂直对齐模式：'bottom'，'distributed'，'justify'，'center'，'top'")])])])]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" openpyxl"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("styles "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" Alignment\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" openpyxl "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" load_workbook\n\n\nworkbook "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" load_workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsheet "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("active\ncell "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nalignment "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Alignment"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("horizontal"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"center"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" vertical"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"center"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" text_rotation"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("45")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" wrap_text"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("True")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ncell"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("alignment "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" alignment\nworkbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("save"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("h3",{attrs:{id:"设置边框样式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#设置边框样式"}},[s._v("#")]),s._v(" 设置边框样式")]),s._v(" "),n("ul",[n("li",[n("code",[s._v("Side(style=边线样式, color=边线颜色)")]),s._v(" 和 "),n("code",[s._v("Border(left=左边线样式, right=右边线样式, top=上边线样式, bottom=下边线样式)")]),s._v(" "),n("ul",[n("li",[s._v("style 参数：'double', 'mediumDashDotDot', 'slantDashDot', 'dashDotDot', 'dotted', 'hair', 'mediumDashed, 'dashed', 'dashDot', 'thin', 'mediumDashDot', 'medium', 'thick'")])])])]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" openpyxl"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("styles "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" Side"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Border\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" openpyxl "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" load_workbook\n\n\nworkbook "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" load_workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsheet "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("active\ncell "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"D6"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nside1 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Side"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("style"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"thin"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" color"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"FF0000"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nside2 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Side"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("style"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"thick"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" color"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"FFFF00"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nborder "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Border"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("left"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("side1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" right"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("side1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" top"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("side2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" bottom"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("side2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ncell"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("border "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" border\nworkbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("save"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("h3",{attrs:{id:"设置填充样式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#设置填充样式"}},[s._v("#")]),s._v(" 设置填充样式")]),s._v(" "),n("ul",[n("li",[n("code",[s._v("PatternFill(fill_type=填充样式，fgColor=填充颜色）")])]),s._v(" "),n("li",[n("code",[s._v("GradientFill(stop=(渐变颜色1，渐变颜色2……))")])])]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" openpyxl"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("styles "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" PatternFill"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("GradientFill\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" openpyxl "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" load_workbook\n\n\nworkbook "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" load_workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsheet "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("active\ncell_b9 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"B9"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\npattern_fill "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" PatternFill"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fill_type"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"solid"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("fgColor"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"99ccff"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ncell_b9"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("fill "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pattern_fill\ncell_b10 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"B10"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\ngradient_fill "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" GradientFill"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("stop"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"FFFFFF"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"99ccff"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"000000"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ncell_b10"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("fill "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" gradient_fill\nworkbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("save"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("h3",{attrs:{id:"设置行高和列宽"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#设置行高和列宽"}},[s._v("#")]),s._v(" 设置行高和列宽")]),s._v(" "),n("ul",[n("li",[n("code",[s._v(".row_dimensions[行编号].height = 行高")])]),s._v(" "),n("li",[n("code",[s._v(".column_dimensions[列编号].width = 列宽")])])]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[s._v("workbook "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" load_workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsheet "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("active\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置第1行的高度")]),s._v("\nsheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("row_dimensions"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("height "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置B列的宽度")]),s._v("\nsheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("column_dimensions"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"B"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("width "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("\nworkbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("save"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v('"""\n也可以设置整个 Sheet 表的行高和列宽：\nsheet.row_dimensions.height = 50\nsheet.column_dimensions.width = 30\n"""')]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("h3",{attrs:{id:"合并单元格"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#合并单元格"}},[s._v("#")]),s._v(" 合并单元格")]),s._v(" "),n("ul",[n("li",[n("code",[s._v(".merge_cells(待合并的格子编号)")])]),s._v(" "),n("li",[n("code",[s._v(".merge_cells(start_row=起始行号，start_column=起始列号，end_row=结束行号，end_column=结束列号)")])])]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[s._v("workbook "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" load_workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsheet "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" workbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("active\nsheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("merge_cells"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"C1:D2"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nsheet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("merge_cells"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("start_row"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" start_column"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" end_row"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" end_column"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nworkbook"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("save"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filename"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.xlsx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("也可以取消合并单元格，用法一致")]),s._v(" "),n("ul",[n("li",[n("code",[s._v(".unmerge_cells(待合并的格子编号)")])]),s._v(" "),n("li",[n("code",[s._v(".unmerge_cells(start_row=起始行号，start_column=起始列号，end_row=结束行号，end_column=结束列号)")])])]),s._v(" "),n("h2",{attrs:{id:"参考资料"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[s._v("#")]),s._v(" 参考资料")]),s._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://openpyxl.readthedocs.io/en/stable/",target:"_blank",rel:"noopener noreferrer"}},[s._v("openpyxl"),n("OutboundLink")],1)])]),s._v(" "),n("p",[s._v("（完）")])])}),[],!1,null,null,null);t.default=e.exports},645:function(s,t,a){s.exports=a.p+"assets/img/write-xlsx.8c935edd.png"},646:function(s,t,a){s.exports=a.p+"assets/img/read-xlsx.0e1fee0e.png"}}]);