(window.webpackJsonp=window.webpackJsonp||[]).push([[126],{1306:function(s,i,t){"use strict";t.r(i);var e=t(1),v=Object(e.a)({},(function(){var s=this,i=s.$createElement,e=s._self._c||i;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"session"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#session"}},[s._v("#")]),s._v(" Session")]),s._v(" "),e("h2",{attrs:{id:"什么是-session"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#什么是-session"}},[s._v("#")]),s._v(" 什么是 Session")]),s._v(" "),e("p",[s._v("通过 K-V 数据格式来保存数据：")]),s._v(" "),e("ul",[e("li",[s._v("K: 称为 SessionID 保存在客户端")]),s._v(" "),e("li",[s._v("V: 称为 Session 保存在服务端")])]),s._v(" "),e("p",[e("strong",[s._v("注意")]),s._v("：")]),s._v(" "),e("ul",[e("li",[s._v("客户端只要存储 SessionID 具体映射的数据结构存储在服务端")]),s._v(" "),e("li",[s._v("跳出了浏览器 Cookie 只能存储字符型的限制")]),s._v(" "),e("li",[s._v("客户端存储 SessionID 还是需要借助 Cookie 实现")])]),s._v(" "),e("h2",{attrs:{id:"具体流程"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#具体流程"}},[s._v("#")]),s._v(" 具体流程")]),s._v(" "),e("p",[e("img",{attrs:{src:t(747),alt:"session"}})]),s._v(" "),e("ul",[e("li",[s._v("接口登录成功后，服务器生成 SessionID 和 Session")]),s._v(" "),e("li",[s._v("将 SessionID 返给客户端")]),s._v(" "),e("li",[s._v("客户端发送 HTTP 请求时，会携带 Cookie 中的 SessionID")]),s._v(" "),e("li",[s._v("服务端获得 SessionID 后，根据值找到对应的 Session 数据比对\n"),e("img",{attrs:{src:t(748),alt:"session1"}})])]),s._v(" "),e("h2",{attrs:{id:"优势与不足"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#优势与不足"}},[s._v("#")]),s._v(" 优势与不足")]),s._v(" "),e("h3",{attrs:{id:"优势"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#优势"}},[s._v("#")]),s._v(" 优势")]),s._v(" "),e("ul",[e("li",[s._v("传输数据少，数据结构灵活")])]),s._v(" "),e("p",[s._v("相较于 Cookie 来说，客户端仅保留 SessionID ，传输数据量小，速度快")]),s._v(" "),e("ul",[e("li",[s._v("更安全")])]),s._v(" "),e("p",[s._v("Session 的验证都是在服务端按照指定规则完成，而 Cookie 可能被客户端通过 JavaScript 代码篡改")]),s._v(" "),e("h3",{attrs:{id:"不足"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#不足"}},[s._v("#")]),s._v(" 不足")]),s._v(" "),e("ul",[e("li",[s._v("Session 会在一定时间内保存在服务器上，当访问增多，会比较占用服务器的性能")]),s._v(" "),e("li",[s._v("多台后端服务器无法共享 Session")])]),s._v(" "),e("p",[s._v("分布式部署服务时，不能共享服务器之间的状态")]),s._v(" "),e("p",[e("strong",[s._v("解决方案")]),s._v("：")]),s._v(" "),e("ul",[e("li",[s._v("专门准备一台服务器存储 Session，所有有关 Session 的操作都由它调用")])]),s._v(" "),e("p",[e("strong",[s._v("注意")]),s._v("：只是单点服务器时，如果服务器 down 机了，Session 就不能查询")]),s._v(" "),e("ul",[e("li",[s._v("服务器之间的调用，可以通过内网 IP 走 RPC 调用（不走 HTTP）")])]),s._v(" "),e("p",[s._v("（完）")])])}),[],!1,null,null,null);i.default=v.exports},747:function(s,i,t){s.exports=t.p+"assets/img/session.04fc7d06.png"},748:function(s,i,t){s.exports=t.p+"assets/img/session1.1c381ea7.png"}}]);