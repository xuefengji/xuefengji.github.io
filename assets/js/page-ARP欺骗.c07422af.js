(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{1077:function(t,s,a){"use strict";a.r(s);var v=a(1),e=Object(v.a)({},(function(){var t=this,s=t.$createElement,v=t._self._c||s;return v("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[v("h1",{attrs:{id:"arp-欺骗"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#arp-欺骗"}},[t._v("#")]),t._v(" ARP 欺骗")]),t._v(" "),v("p",[t._v("前提：了解什么是 ARP，可以参考 "),v("a",{attrs:{href:"/basic-skills/network/ARP%E5%8D%8F%E8%AE%AE"}},[t._v("ARP协议")])]),t._v(" "),v("p",[v("strong",[t._v("注意")]),t._v("：ARP 欺骗是内网（局域网）的一种攻击手段")]),t._v(" "),v("h2",{attrs:{id:"什么是-arp-欺骗"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#什么是-arp-欺骗"}},[t._v("#")]),t._v(" 什么是 ARP 欺骗")]),t._v(" "),v("h3",{attrs:{id:"正常数据传输"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#正常数据传输"}},[t._v("#")]),t._v(" 正常数据传输：")]),t._v(" "),v("p",[v("img",{attrs:{src:a(563),alt:"arp"}})]),t._v(" "),v("p",[t._v("client1 与 client2 通信的过程：")]),t._v(" "),v("p",[v("strong",[t._v("第一步")]),t._v(":")]),t._v(" "),v("p",[t._v("client1 检测到要通信的地址是同一网段的，会发出消息“谁是 192.168.1.3”")]),t._v(" "),v("p",[v("strong",[t._v("第二步")]),t._v("：")]),t._v(" "),v("p",[t._v("交换机端口收到消息后，会将该消息在全局域网类进行关播，并将 client1 连接的端口与 MAC 写入 MAC 地址表中")]),t._v(" "),v("p",[v("strong",[t._v("第三步")]),t._v("：")]),t._v(" "),v("ul",[v("li",[t._v("client2 接收到消息后，会回复 client1 “我是 192.168.1.3，MAC 地址是 10-e9-53-15-8b-4c”")]),t._v(" "),v("li",[t._v("client2 会将 client1 的 IP 与 MAC 写入 ARP 缓存表中")]),t._v(" "),v("li",[t._v("交换机收到该消息后，会将 client2 连接的端口与 MAC 写入 MAC 地址表中")]),t._v(" "),v("li",[t._v("client1 会将 client2 的 IP 与 MAC 写入 ARP 缓存表中")])]),t._v(" "),v("p",[v("strong",[t._v("第四步")]),t._v(":")]),t._v(" "),v("p",[t._v("client1 将数据发送给 client2时，交换机会进行相应端口转发")]),t._v(" "),v("p",[v("strong",[t._v("重点")]),t._v("：")]),t._v(" "),v("ul",[v("li",[t._v("ARP 缓存表有失效时间")]),t._v(" "),v("li",[t._v("client1 的缓存未失效时，不会重新发送消息查询 client2 的 MAC 地址")])]),t._v(" "),v("h3",{attrs:{id:"被欺骗-的数据传输"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#被欺骗-的数据传输"}},[t._v("#")]),t._v(" “被欺骗”的数据传输")]),t._v(" "),v("p",[v("img",{attrs:{src:a(564),alt:"arp"}})]),t._v(" "),v("p",[t._v("client1 与 client2 通信的过程：")]),t._v(" "),v("p",[v("strong",[t._v("第一步")]),t._v(":")]),t._v(" "),v("p",[t._v("client1 检测到要通信的地址是同一网段的，会发出消息“谁是 192.168.1.3”")]),t._v(" "),v("p",[v("strong",[t._v("第二步")]),t._v("：")]),t._v(" "),v("p",[t._v("交换机端口收到消息后，会将该消息在全局域网类进行关播，并将 client1 连接的端口与 MAC 写入 MAC 地址表中")]),t._v(" "),v("p",[v("strong",[t._v("第三步")]),t._v("：")]),t._v(" "),v("ul",[v("li",[t._v("client3 接收到消息后，疯狂的回复 client1 “我是 192.168.1.3，MAC 地址是 10-e9-53-15-8b-4b”")]),t._v(" "),v("li",[t._v("client3 会将 client1 的 IP 与 MAC 写入 ARP 缓存表中")]),t._v(" "),v("li",[t._v("交换机收到该消息后，会将 client3 连接的端口与 MAC 写入 MAC 地址表中")]),t._v(" "),v("li",[t._v("client1 会将 client3 的 IP 与 MAC 写入 ARP 缓存表中")])]),t._v(" "),v("p",[v("strong",[t._v("第四步")]),t._v(":")]),t._v(" "),v("p",[t._v("client1 将数据发送给 client2 时，交换机会进行相应端口转发，此时就会转发给 client3")]),t._v(" "),v("h3",{attrs:{id:"arp-欺骗的原因"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#arp-欺骗的原因"}},[t._v("#")]),t._v(" ARP 欺骗的原因")]),t._v(" "),v("p",[t._v("根据上面的例子可以看出，ARP 存在的原因：")]),t._v(" "),v("ul",[v("li",[t._v("在 ARP回复时，发送请求包的主机 client1 并不会验证 ARP 回复包的真实性")]),t._v(" "),v("li",[t._v("client1 不能判断回复自己的是不是主机 client2")]),t._v(" "),v("li",[t._v("由此引出一个局域网攻击方式 ARP 欺骗")])]),t._v(" "),v("h2",{attrs:{id:"arp-欺骗的分类"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#arp-欺骗的分类"}},[t._v("#")]),t._v(" ARP 欺骗的分类")]),t._v(" "),v("ul",[v("li",[t._v("主机欺骗\n如同上面的例子，client3 欺骗 client1")]),t._v(" "),v("li",[t._v("网关欺骗\n局域网中的主机欺骗网关，从而获取其他主机的进流量")])]),t._v(" "),v("h2",{attrs:{id:"arp-攻击的危害"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#arp-攻击的危害"}},[t._v("#")]),t._v(" ARP 攻击的危害")]),t._v(" "),v("ul",[v("li",[t._v("造成局域网中的其他主机断网")]),t._v(" "),v("li",[t._v("劫持局域网中其他主机或网关的流量，获取敏感信息等")])]),t._v(" "),v("h2",{attrs:{id:"如何防御-arp-欺骗"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#如何防御-arp-欺骗"}},[t._v("#")]),t._v(" 如何防御 ARP 欺骗")]),t._v(" "),v("p",[t._v("ARP 欺骗是通过重复应答实现的，只需要在本机添加一条静态的 ARP 映射，这样就不需要询问网关 MAC 地址了，"),v("strong",[t._v("这种方法只对主机欺骗有效")])]),t._v(" "),v("h3",{attrs:{id:"步骤"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#步骤"}},[t._v("#")]),t._v(" 步骤")]),t._v(" "),v("h4",{attrs:{id:"查看网络"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#查看网络"}},[t._v("#")]),t._v(" 查看网络")]),t._v(" "),v("p",[t._v("用管理身份运行命令提示符，输入 "),v("code",[t._v("netsh i i show in")]),t._v(" 查看一下本机有哪些网络连接")]),t._v(" "),v("div",{staticClass:"language-shell line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-shell"}},[v("code",[t._v("netsh i i show "),v("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v("\n")])]),t._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[t._v("1")]),v("br")])]),v("h4",{attrs:{id:"查询网关-mac"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#查询网关-mac"}},[t._v("#")]),t._v(" 查询网关 MAC")]),t._v(" "),v("p",[t._v("输入 "),v("code",[t._v("arp -a")]),t._v(" 查询本机的网关信息")]),t._v(" "),v("div",{staticClass:"language-shell line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-shell"}},[v("code",[t._v("arp -a\n")])]),t._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[t._v("1")]),v("br")])]),v("div",{staticClass:"custom-block warning"},[v("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),v("p",[t._v("如果正遭受 ARP 欺骗攻击，通过此方法查处的可能是虚假的 MAC 地址")])]),t._v(" "),v("h4",{attrs:{id:"绑定-ip-和-mac"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#绑定-ip-和-mac"}},[t._v("#")]),t._v(" 绑定 IP 和 MAC")]),t._v(" "),v("p",[t._v("输入以下命令对网关的 IP 和 MAC 添加静态映射")]),t._v(" "),v("div",{staticClass:"language-shell line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-shell"}},[v("code",[t._v("netsh -c "),v("span",{pre:!0,attrs:{class:"token string"}},[t._v('"i i"')]),t._v(" "),v("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" neighbors 连接的Idx号 网关IP 网关MAC\nnetsh -c "),v("span",{pre:!0,attrs:{class:"token string"}},[t._v('"i i"')]),t._v(" "),v("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" neighbors "),v("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),t._v(" "),v("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.60")]),t._v(".12.1 4c-5e-0c-64-73-f5\n")])]),t._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[t._v("1")]),v("br"),v("span",{staticClass:"line-number"},[t._v("2")]),v("br")])])])}),[],!1,null,null,null);s.default=e.exports},563:function(t,s,a){t.exports=a.p+"assets/img/arpqp.02202fc1.png"},564:function(t,s,a){t.exports=a.p+"assets/img/arpqp1.936eb221.png"}}]);