(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{661:function(s,a,t){"use strict";t.r(a);var n=t(1),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"es-的安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#es-的安装"}},[s._v("#")]),s._v(" ES 的安装")]),s._v(" "),t("h2",{attrs:{id:"ubuntu-下安装-es"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ubuntu-下安装-es"}},[s._v("#")]),s._v(" Ubuntu 下安装 ES")]),s._v(" "),t("h3",{attrs:{id:"下载、解压-es-安装包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#下载、解压-es-安装包"}},[s._v("#")]),s._v(" 下载、解压 ES 安装包")]),s._v(" "),t("p",[s._v("可以在"),t("a",{attrs:{href:"https://www.elastic.co/cn/downloads/elasticsearch",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方下载页面"),t("OutboundLink")],1),s._v("进行下载，然后上传到服务器。")]),s._v(" "),t("p",[s._v("也可以在 Ubuntu 上使用 "),t("code",[s._v("wget")]),s._v(" 指令进行下载，然后解压：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 我一般将 ES 安装在 /opt 目录下")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /opt\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.13.0-linux-x86_64.tar.gz\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zxvf elasticsearch-7.13.0-linux-x86_64.tar.gz\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("解压后可以看到 ES 的文件目录结构如下：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("├── elasticsearch-7.13.0\n    │── bin              # 包含一些执行脚本，其中 ES 的启动文件和脚本安装文件就在这里\n    │── config           # 包含集群的配置文件（elasticsearch.yml）、jvm配置（jvm.options）、user等相关配置\n    │── jdk              # 7.0 后自带 jdk，java 运行环境\n    │── lib              # java 的类库\n    │── LICENSE.txt\n    │── logs\n    │── modules          # 包含所有 ES 的模块\n    │── NOTICE.txt\n    │── plugins          # 插件安装的目录\n    └── README.asciidoc\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("h3",{attrs:{id:"修改-es-服务配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#修改-es-服务配置"}},[s._v("#")]),s._v(" 修改 ES 服务配置")]),s._v(" "),t("p",[s._v("虽然 ES 可以开箱即用，但这里我们还是需要修改部分配置的。ES 的配置文件在 config 目录内，我们主要关注两个配置文件："),t("code",[s._v("elasticsearch.yml")]),s._v(" 和 "),t("code",[s._v("jvm.options")]),s._v("。")]),s._v(" "),t("p",[s._v("elasticsearch.yml 是用来配置 ES 服务的各种参数的，而 jvm.options 主要保存 JVM 相关的配置。")]),s._v(" "),t("p",[s._v("编辑配置文件 "),t("code",[s._v("vim /config/elasticsearch.yml")]),s._v("，在最后添加如下配置项：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 建议和前面的内容之间加个空行，可以更清晰些")]),s._v("\n\ncluster.name: my_app\nnode.name: my_node_1\npath.data: ./data\npath.logs: ./logs\nhttp.port: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9211")]),s._v("\nnetwork.host: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 线上一定不能配置为 0.0.0.0")]),s._v("\ndiscovery.seed_hosts: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"localhost"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\ncluster.initial_master_nodes: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"my_node_1"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("p",[s._v("配置项解析：")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("discovery.seed_hosts")]),s._v("：在开箱即用的场景下（本机环境）无需配置，ES 会自动扫描本机的 9300 到9305 端口。一旦进行了网络环境配置，这个自动扫描操作就不会执行。\n"),t("ul",[t("li",[s._v("将它的值配置为 master 候选者节点即可。如果需要指定端口的话，其值可以为："),t("code",[s._v('["localhost:9300", "localhost:9301"]')])])])]),s._v(" "),t("li",[t("code",[s._v("cluster.initial_master_nodes")]),s._v("：指定新集群 master 候选者列表，其值为节点的名字列表。\n"),t("ul",[t("li",[s._v("这里配置了 "),t("code",[s._v("node.name: my_node_1")]),s._v("，所以其值为 "),t("code",[s._v('["my_node_1"]')]),s._v("，而不是 ip 列表。")])])]),s._v(" "),t("li",[t("code",[s._v("network.host")]),s._v(" 和 "),t("code",[s._v("http.port")]),s._v("：这是 ES 提供服务的监听地址和端口。\n"),t("ul",[t("li",[s._v("线上一定不能配置 ip 为 0.0.0.0，这是非常危险的行为！！！")])])])]),s._v(" "),t("blockquote",[t("p",[s._v("怎么样来理解这个 "),t("code",[s._v("discovery.seed_hosts")]),s._v(" 和 "),t("code",[s._v("cluster.initial_master_nodes")]),s._v(" 呢？")]),s._v(" "),t("ul",[t("li",[t("p",[t("code",[s._v("cluster.initial_master_nodes")]),s._v(" 是候选者列表，一般我们线上环境候选者的数量会比较少，毕竟是用来做备用的。而且这个配置只跟选举 master 有关，也就是跟其他类型的节点没有关系，其他类型的节点不需要配置这个也是可以的。")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("discovery.seed_hosts")]),s._v(" 这个可以理解为是做服务或者节点发现的，其他节点必须知道他们才能进入集群，一般配置为集群的 master 候选者的列表。")])])]),s._v(" "),t("p",[s._v("在现实环境中是这些 master 候选者（组织联系人）可能会经常变化，那怎么办呢？")]),s._v(" "),t("p",[t("code",[s._v("discovery.seed_hosts")]),s._v(" 这个配置项除了支持 ip 外还支持域名，所以可以用域名来解决这个问题。其他类型节点的配置上写的是域名，域名解析到对应的 ip，如果机器挂了，新的节点 ip 换了，就把域名解析到新的 ip 即可，这样其他节点的配就不用修改了。所以非 master 候选节点要配 "),t("code",[s._v("discovery.seed_hosts")]),s._v("（组织联系人）才能顺利加入到集群中来。")])]),s._v(" "),t("h3",{attrs:{id:"修改-jvm-参数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#修改-jvm-参数"}},[s._v("#")]),s._v(" 修改 JVM 参数")]),s._v(" "),t("p",[s._v("除了修改 ES 服务配置外，还需要在 jvm.options 文件中配置 JVM 的参数，我们主要配置服务占用的堆内存的大小：")]),s._v(" "),t("p",[s._v("编辑配置文件 "),t("code",[s._v("vim /config/jvm.options")]),s._v("，在最后添加如下配置项：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 建议和前面的内容之间加个空行，可以更清晰些")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置堆内存最小值")]),s._v("\n-Xms1g\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置堆内存最大值")]),s._v("\n-Xmx1g\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("JVM 配置需要注意以下几点：")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("-Xms 和 -Xmx 这两个 JVM 的参数必须配置为一样的数值")]),s._v("。服务在启动的时候就分配好内存空间，避免运行时申请分配内存造成系统抖动。")]),s._v(" "),t("li",[t("strong",[s._v("Xmx 不要超过机器内存的 50%，留下些内存供 JVM 堆外内存使用")]),s._v("。")]),s._v(" "),t("li",[t("strong",[s._v("并且 Xmx 不要超过 32G，建议最大配置为 30G")]),s._v("。接近 32G，JVM 会启用压缩对象指针的功能，导致性能下降。具体可以参考："),t("a",{attrs:{href:"https://www.elastic.co/cn/blog/a-heap-of-trouble",target:"_blank",rel:"noopener noreferrer"}},[s._v("a-heap-of-trouble"),t("OutboundLink")],1),s._v("。")])]),s._v(" "),t("h3",{attrs:{id:"配置系统环境"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置系统环境"}},[s._v("#")]),s._v(" 配置系统环境")]),s._v(" "),t("p",[s._v("如果就上面的配置进行启动，ES 会报错：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("bootstrap check failure "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" of "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(":\n\nmax virtual memory areas vm.max_map_count "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("65530")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" is too low, increase to at least "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("262144")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("按照提示进行操作系统配置就可以了，执行 "),t("code",[s._v("vim /etc/sysctl.conf")]),s._v(" 指令，添加如下内容来配置系统环境：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 建议和前面的内容之间加个空行，可以更清晰些")]),s._v("\n\nvm.max_map_count"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("262144")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("然后执行 "),t("code",[s._v("sysctl -p")]),s._v("。")]),s._v(" "),t("h3",{attrs:{id:"创建用户并赋予权限"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建用户并赋予权限"}},[s._v("#")]),s._v(" 创建用户并赋予权限")]),s._v(" "),t("p",[s._v("创建一个名为 elasticsearch 的用户：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 为 ES 创建一个不能 ssh 登陆的用户，且不创建用户主目录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("useradd")]),s._v(" elasticsearch -s /sbin/nologin -M\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改文件所有者")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" -R elasticsearch:elasticsearch /opt/elasticsearch-7.13.0/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h3",{attrs:{id:"前台运行-es"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#前台运行-es"}},[s._v("#")]),s._v(" 前台运行 ES")]),s._v(" "),t("p",[s._v("注意，ES 不能使用 root 来运行！！！！")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 前台运行，可以直接查看日志")]),s._v("\n.bin/elasticsearch\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 后台运行，日志在 ./logs/my_app.log")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看日志的话可以：tail -n 100 -f logs/my_app.log")]),s._v("\n.bin/elasticsearch -d\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("在浏览器中访问 localhost:9211，可以看到有关节点信息的内容即运行成功。")]),s._v(" "),t("h2",{attrs:{id:"ubuntu-下安装-kibana"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ubuntu-下安装-kibana"}},[s._v("#")]),s._v(" Ubuntu 下安装 Kibana")]),s._v(" "),t("h3",{attrs:{id:"下载、解压"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#下载、解压"}},[s._v("#")]),s._v(" 下载、解压")]),s._v(" "),t("p",[s._v("Kibana 是官方的数据分析和可视化平台，但现在我们只需要把它当作 ES 查询的调试工具即可。Kibana 与 ES 的版本是有对应关系的，所以需要下载与 ES 同版本的 Kibana，在这里下载 "),t("a",{attrs:{href:"https://www.elastic.co/cn/downloads/kibana",target:"_blank",rel:"noopener noreferrer"}},[s._v("Kibana"),t("OutboundLink")],1),s._v("。")]),s._v(" "),t("p",[s._v("下面是使用 "),t("code",[s._v("wget")]),s._v(" 下载并且解压安装 Kibana 的指令（版本与前面安装的 ES 一致，都是 7.13.0）：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 还是安装在 /opt 目录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /opt\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://artifacts.elastic.co/downloads/kibana/kibana-7.13.0-linux-x86_64.tar.gz\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zxvf kibana-7.13.0-linux-x86_64.tar.gz\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重命名")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" kibana-7.13.0-linux-x86_64 kibana-7.13.0\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入安装目录，准备做一些配置")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" kibana-7.13.0\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("h3",{attrs:{id:"修改服务配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#修改服务配置"}},[s._v("#")]),s._v(" 修改服务配置")]),s._v(" "),t("p",[s._v("编辑配置文件 "),t("code",[s._v("vim /config/kibana.yml")]),s._v("，在最后添加如下配置项：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 建议和前面的内容之间加个空行，可以更清晰些")]),s._v("\n\nserver.host: "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0.0.0.0"')]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 线上一定不能配置ip为 0.0.0.0，这是非常危险的行为！！！")]),s._v("\n\nelasticsearch.hosts: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://localhost:9211"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("前面创建过一个名为 elasticsearch 的用户，这里的 Kibana 也用这个用户来运行吧，保持一致。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改文件所有者")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" -R elasticsearch:elasticsearch /opt/kibana-7.13.0/\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"前台运行-kibana"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#前台运行-kibana"}},[s._v("#")]),s._v(" 前台运行 Kibana")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("./bin/kibana "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" run.log "),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("2")]),s._v(">")]),t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("&1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("安装完成后，在浏览器中访问 localhost:5601，如果运行成功可以进入到可视化操作界面。")]),s._v(" "),t("p",[s._v("打开 Dev Tools 即可开始你的查询了，新版的 Kibana 加入了很多功能，比我之前用的 5.x 丰富很多。")]),s._v(" "),t("h2",{attrs:{id:"安装-cerebro"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装-cerebro"}},[s._v("#")]),s._v(" 安装 Cerebro")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://github.com/lmenezes/cerebro",target:"_blank",rel:"noopener noreferrer"}},[s._v("Cerebro"),t("OutboundLink")],1),s._v(" 是一个简单的 ES 集群管理工具，其安装如下：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /opt\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://github.com//lmenezes/cerebro/releases/download/v0.9.4/cerebro-0.9.4.tgz\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zxvf cerebro-0.9.4.tgz\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" cerebro-0.9.4 cerebro\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" cerebro\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" -i "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/server.http.port = ${?CEREBRO_PORT}/server.http.port = 9800/g'")]),s._v(" conf/application.conf\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" -e "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'\\nhosts = [\n    {\n        host = "http://localhost:9211"\n        name = "my_app"\n    }\n]\'')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" conf/application.conf\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br")])]),t("p",[s._v("配置完成后，运行以下指令启动 Cerebro：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动， 在 run.log 中查看日志")]),s._v("\n.bin/cerebro "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" run.log "),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("2")]),s._v(">")]),t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("&1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("如果启动成功，在浏览器中访问 localhost:9800 即可访问 Cerebro。")]),s._v(" "),t("p",[s._v("（完）")])])}),[],!1,null,null,null);a.default=e.exports}}]);