(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{1009:function(s,t,a){"use strict";a.r(t);var e=a(1),r=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"dockerfile"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile"}},[s._v("#")]),s._v(" DockerFile")]),s._v(" "),a("h2",{attrs:{id:"什么是-dockerfile"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#什么是-dockerfile"}},[s._v("#")]),s._v(" 什么是 DockerFile")]),s._v(" "),a("ul",[a("li",[s._v("用来构建 docker 镜像的构建文件")]),s._v(" "),a("li",[s._v("就是命令脚本")])]),s._v(" "),a("h2",{attrs:{id:"构建步骤"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#构建步骤"}},[s._v("#")]),s._v(" 构建步骤")]),s._v(" "),a("ul",[a("li",[s._v("编写一个 DockerFile 文件")]),s._v(" "),a("li",[s._v("docker build 构建成为一个镜像")]),s._v(" "),a("li",[s._v("docker run 运行镜像")]),s._v(" "),a("li",[s._v("docker push 发布镜像（DockerHub 、阿里云仓库)")])]),s._v(" "),a("h2",{attrs:{id:"dockerfile-构建过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile-构建过程"}},[s._v("#")]),s._v(" DockerFile 构建过程")]),s._v(" "),a("ul",[a("li",[s._v("每个保留关键字(指令）都是必须是大写字母")]),s._v(" "),a("li",[s._v("执行从上到下顺序")]),s._v(" "),a("li",[a("code",[s._v("#")]),s._v("表示注释")]),s._v(" "),a("li",[s._v("每一个指令都会创建提交一个新的镜像层，并提交")])]),s._v(" "),a("h2",{attrs:{id:"dockerfile-优势"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile-优势"}},[s._v("#")]),s._v(" DockerFile 优势")]),s._v(" "),a("ul",[a("li",[s._v("DockerFile 是面向开发的，以后要发布项目，做镜像，就需要编写 DockerFile 文件")]),s._v(" "),a("li",[s._v("Docker 镜像逐渐成企业交付的标准，必须要掌握！")]),s._v(" "),a("li",[s._v("DockerFile 构建镜像文件，定义了一切的步骤，源代码")]),s._v(" "),a("li",[s._v("Dockerfile 的体积小，容易进行快速迁移部署")]),s._v(" "),a("li",[s._v("环境构建流程记录在 DockerFile 中，能够直观的看到镜像构建的顺序和逻辑")]),s._v(" "),a("li",[s._v("Docker Images 通过 DockerFile 构建生成的镜像，最终发布和运行产品")]),s._v(" "),a("li",[s._v("Docker 容器，镜像运行起来提供服务")])]),s._v(" "),a("h2",{attrs:{id:"常用指令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常用指令"}},[s._v("#")]),s._v(" 常用指令")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("指令")]),s._v(" "),a("th",[s._v("说明")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("FROM")]),s._v(" "),a("td",[s._v("指明当前的镜像基于哪个镜像构建")])]),s._v(" "),a("tr",[a("td",[s._v("ARG")]),s._v(" "),a("td",[s._v("定义构建镜像过程中使用的变量")])]),s._v(" "),a("tr",[a("td",[s._v("LABEL")]),s._v(" "),a("td",[s._v("标记镜像信息，添加元数据")])]),s._v(" "),a("tr",[a("td",[s._v("EXPOSE")]),s._v(" "),a("td",[s._v("暴露 Docker 容器在运行时监听指定的网络端口")])]),s._v(" "),a("tr",[a("td",[s._v("ENV")]),s._v(" "),a("td",[s._v("指定环境变量")])]),s._v(" "),a("tr",[a("td",[s._v("ENTRYPOINT")]),s._v(" "),a("td",[s._v("指定镜像的默认入口命令")])]),s._v(" "),a("tr",[a("td",[s._v("VOLUME")]),s._v(" "),a("td",[s._v("创建一个数据卷挂载点")])]),s._v(" "),a("tr",[a("td",[s._v("USER")]),s._v(" "),a("td",[s._v("指定运行容器时的用户名或 UID")])]),s._v(" "),a("tr",[a("td",[s._v("WORKDIR")]),s._v(" "),a("td",[s._v("配置工作目录")])]),s._v(" "),a("tr",[a("td",[s._v("RUN")]),s._v(" "),a("td",[s._v("运行指定命令")])]),s._v(" "),a("tr",[a("td",[s._v("CMD")]),s._v(" "),a("td",[s._v("启动容器时指定默认执行的命令")])]),s._v(" "),a("tr",[a("td",[s._v("ADD")]),s._v(" "),a("td",[s._v("添加内容到镜像")])]),s._v(" "),a("tr",[a("td",[s._v("COPY")]),s._v(" "),a("td",[s._v("复制内容到镜像")])]),s._v(" "),a("tr",[a("td",[s._v("ONBUILD")]),s._v(" "),a("td",[s._v("创建子镜像时指定自动执行的操作指令")])]),s._v(" "),a("tr",[a("td",[s._v("STOPSIGNAL")]),s._v(" "),a("td",[s._v("指定退出的信号值")])]),s._v(" "),a("tr",[a("td",[s._v("HEALTHCHECK")]),s._v(" "),a("td",[s._v("配置启动容器如何进行健康检查")])]),s._v(" "),a("tr",[a("td",[s._v("SHELL")]),s._v(" "),a("td",[s._v("指定默认 shell 类型")])])])]),s._v(" "),a("h2",{attrs:{id:"示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[s._v("#")]),s._v(" 示例")]),s._v(" "),a("p",[s._v("构建含有 ifconfig 、vim 命令的 centos")]),s._v(" "),a("p",[s._v("DockerFile 内容：")]),s._v(" "),a("div",{staticClass:"language-shell script line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("FROM centos\nMAINTAINER snowji"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456789")]),s._v("@qq.com"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\nENV MYPATH /usr/local\nWORKDIR "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$MYPATH")]),s._v("\n\nRUN yum -y "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" net-tools   \n\nEXPOSE "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n\nCMD "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$MYPATH")]),s._v("\nCMD "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-----end-----"')]),s._v("\nCMD /bin/bash\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[s._v("build 结束后，进入容器使用 "),a("code",[s._v("ifconfig")]),s._v(" 命令")]),s._v(" "),a("div",{staticClass:"language-shell script line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@1afccfd13f3d local"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ifconfig")]),s._v("\neth0: "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("flags")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("416")]),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("3")]),s._v("<")]),s._v("UP,BROADCAST,RUNNING,MULTICAST"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("  mtu "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1500")]),s._v("\n        inet "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1  netmask "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("255.255")]),s._v(".0.0  broadcast "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.2\n        ether 02:42:xx:xx:00:03  txqueuelen "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Ethernet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        RX packets "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("  bytes "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("586")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("586.0")]),s._v(" B"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        RX errors "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  dropped "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  overruns "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  frame "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n        TX packets "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  bytes "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(" B"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        TX errors "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  dropped "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" overruns "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  carrier "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  collisions "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\nlo: "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("flags")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("3")]),s._v("<")]),s._v("UP,LOOPBACK,RUNNING"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("  mtu "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("65536")]),s._v("\n        inet "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1  netmask "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("255.0")]),s._v(".0.0\n        loop  txqueuelen "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Local Loopback"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        RX packets "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  bytes "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(" B"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        RX errors "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  dropped "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  overruns "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  frame "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n        TX packets "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  bytes "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(" B"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        TX errors "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  dropped "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" overruns "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  carrier "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  collisions "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("p",[s._v("可以使用 "),a("code",[s._v("ifconfig")]),s._v(" 命令查看网络信息")]),s._v(" "),a("p",[s._v("（完）")])])}),[],!1,null,null,null);t.default=r.exports}}]);