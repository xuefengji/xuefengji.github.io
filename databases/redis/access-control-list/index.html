<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Redis 的 ACL 安全策略 | 测试开发手册</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/img/snow.png">
    <link rel="stylesheet" href="/css/style.css">
    <script charset="utf-8" src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script charset="utf-8" src="/js/main.js"></script>
    <link rel="alternate" type="application/atom+xml" href="https://www.snowji.cn/atom.xml" title="测试开发手册 Atom Feed">
    <link rel="alternate" type="application/json" href="https://www.snowji.cn/feed.json" title="测试开发手册 JSON Feed">
    <link rel="alternate" type="application/rss+xml" href="https://www.snowji.cn/rss.xml" title="测试开发手册 RSS Feed">
    <meta name="description" content="纪小雪的测试笔记">
    <meta property="og:url" content="/databases/redis/access-control-list.html">
    <meta property="og:site_name" content="测试开发手册">
    <meta property="og:title" content="Redis 的 ACL 安全策略">
    <meta property="og:description" content="Redis 的 ACL 安全策略 &quot; ACL 是 Redis 6.0 的新特性，主要是做权限控制的&quot; &quot; &quot; &quot; 它的出现是因为在 Redis 6.0 版本之前是没有权限的概念的，所有连接的客户端都可以对 Redis 里面的数据进行操作，也可以使用所有高危命令，比如 flushall 或 flushdb 清空掉数据库里面的所有数据&quot; 背景 最近给新安装的 R">
    <meta property="og:type" content="article">
    <meta property="og:locale" content="zh-CN">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image:alt" content="测试开发手册">
    <meta property="article:author" content="snowji">
    
    <link rel="preload" href="/assets/css/0.styles.b5f89971.css" as="style"><link rel="preload" href="/assets/js/app.b7806c63.js" as="script"><link rel="preload" href="/assets/js/vendors~layout-Layout.38a14c95.js" as="script"><link rel="preload" href="/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound.c1742524.js" as="script"><link rel="preload" href="/assets/js/page-Redis的ACL安全策略.607ab741.js" as="script"><link rel="prefetch" href="/assets/js/layout-Blog.47350adc.js"><link rel="prefetch" href="/assets/js/layout-Layout.18ece50b.js"><link rel="prefetch" href="/assets/js/layout-NotFound.fb069355.js"><link rel="prefetch" href="/assets/js/page---clean清除历史记录.2893f8dc.js"><link rel="prefetch" href="/assets/js/page--088a0e5d.007e51d8.js"><link rel="prefetch" href="/assets/js/page--0d061820.9e8ff1b4.js"><link rel="prefetch" href="/assets/js/page--0deb31bc.e07f6328.js"><link rel="prefetch" href="/assets/js/page--19edd353.aa59c27a.js"><link rel="prefetch" href="/assets/js/page--2d4e3077.4ada3b01.js"><link rel="prefetch" href="/assets/js/page--3219c26d.02b406ee.js"><link rel="prefetch" href="/assets/js/page--34cb791c.0f53935f.js"><link rel="prefetch" href="/assets/js/page--4b912b12.6c3c1cec.js"><link rel="prefetch" href="/assets/js/page--55af8b20.34b77a72.js"><link rel="prefetch" href="/assets/js/page--61e3db86.d6f45f84.js"><link rel="prefetch" href="/assets/js/page--d42680ac.49b101d6.js"><link rel="prefetch" href="/assets/js/page--eb4d0792.e42ee5e5.js"><link rel="prefetch" href="/assets/js/page-2020总结.46c02013.js"><link rel="prefetch" href="/assets/js/page-@alluredescriptiontitle使用.ffe49f3f.js"><link rel="prefetch" href="/assets/js/page-@allurestep@allureattach使用.26fb35fc.js"><link rel="prefetch" href="/assets/js/page-@pytestmarkparametrize参数化.1f1f626f.js"><link rel="prefetch" href="/assets/js/page-ACKFlood攻击.9ca5ea4d.js"><link rel="prefetch" href="/assets/js/page-ARP协议.2ffa08e5.js"><link rel="prefetch" href="/assets/js/page-ARP欺骗.58e1f74c.js"><link rel="prefetch" href="/assets/js/page-Allure主要特性.b974469b.js"><link rel="prefetch" href="/assets/js/page-Allure环境准备.9595a74b.js"><link rel="prefetch" href="/assets/js/page-Appium原理.69be39b7.js"><link rel="prefetch" href="/assets/js/page-AttributeErrorpartiallyinitializedmodule'seleniumwebdriver'hasnoattribute'Chrome'.c3aa3245.js"><link rel="prefetch" href="/assets/js/page-BeanShell.b07bc710.js"><link rel="prefetch" href="/assets/js/page-BitMap位图.e2f1fd5d.js"><link rel="prefetch" href="/assets/js/page-CSRF.15b7af7c.js"><link rel="prefetch" href="/assets/js/page-CSS选择器.bb6b46e4.js"><link rel="prefetch" href="/assets/js/page-CSVDataSetconfig.2df6b290.js"><link rel="prefetch" href="/assets/js/page-Composer.840aeb7f.js"><link rel="prefetch" href="/assets/js/page-ContextManager上下文管理器.2c927744.js"><link rel="prefetch" href="/assets/js/page-Cookie.6a6dbce6.js"><link rel="prefetch" href="/assets/js/page-Counter计数器.9fa99d47.js"><link rel="prefetch" href="/assets/js/page-Crontab.e9929b6c.js"><link rel="prefetch" href="/assets/js/page-DHCPSnooping.dc0f9f80.js"><link rel="prefetch" href="/assets/js/page-DHCP协议.b17115c6.js"><link rel="prefetch" href="/assets/js/page-DNS协议.b539ecc1.js"><link rel="prefetch" href="/assets/js/page-Docker.97bc4b0c.js"><link rel="prefetch" href="/assets/js/page-DockerFile.6a070105.js"><link rel="prefetch" href="/assets/js/page-Docker安装.ebb555e6.js"><link rel="prefetch" href="/assets/js/page-Docker安装Jenkins.e8d6ccee.js"><link rel="prefetch" href="/assets/js/page-Docker环境安装GitLab.15fd40b7.js"><link rel="prefetch" href="/assets/js/page-Docker镜像制作.4bdb63b5.js"><link rel="prefetch" href="/assets/js/page-EOF.191225a4.js"><link rel="prefetch" href="/assets/js/page-ES中的概念与名词.f7717b1c.js"><link rel="prefetch" href="/assets/js/page-ES的安装.205e9275.js"><link rel="prefetch" href="/assets/js/page-ForEach控制器.48bd2b71.js"><link rel="prefetch" href="/assets/js/page-Git.5779fc78.js"><link rel="prefetch" href="/assets/js/page-HTTPS协议.e8b6ed71.js"><link rel="prefetch" href="/assets/js/page-HTTP协议.ebd3c948.js"><link rel="prefetch" href="/assets/js/page-HTTP请求.9209e188.js"><link rel="prefetch" href="/assets/js/page-HTTP请求默认值.40f1d246.js"><link rel="prefetch" href="/assets/js/page-Hash类型.e2233f3a.js"><link rel="prefetch" href="/assets/js/page-Home.1b7dba61.js"><link rel="prefetch" href="/assets/js/page-Hyperloglog基数统计.8566817f.js"><link rel="prefetch" href="/assets/js/page-IP地址.a67cf713.js"><link rel="prefetch" href="/assets/js/page-If控制器.bc7d6654.js"><link rel="prefetch" href="/assets/js/page-JDBCRequest.9e5534ea.js"><link rel="prefetch" href="/assets/js/page-JDBC连接配置.e79e3aea.js"><link rel="prefetch" href="/assets/js/page-JMeter.757f5270.js"><link rel="prefetch" href="/assets/js/page-JMeter录制脚本.c629080d.js"><link rel="prefetch" href="/assets/js/page-JMeter插件安装.16673a41.js"><link rel="prefetch" href="/assets/js/page-JMeter界面介绍.b17cb5b8.js"><link rel="prefetch" href="/assets/js/page-JMeter返回数据乱码问题.f1c6cb9d.js"><link rel="prefetch" href="/assets/js/page-JSON提取器.879179d0.js"><link rel="prefetch" href="/assets/js/page-Jenkins.526befe6.js"><link rel="prefetch" href="/assets/js/page-Jenkins安装.fd19e31a.js"><link rel="prefetch" href="/assets/js/page-Jenkins容器中搭建Python+Pytest+Allure环境.a43a9ca3.js"><link rel="prefetch" href="/assets/js/page-Jmeter+Ant+Jenkins实现自动化.55743f52.js"><link rel="prefetch" href="/assets/js/page-Jmeter安装.9e474fb3.js"><link rel="prefetch" href="/assets/js/page-Linux.ea3f9262.js"><link rel="prefetch" href="/assets/js/page-Linux下安装JMeter.d2acdd1b.js"><link rel="prefetch" href="/assets/js/page-Linux链接.da3df3ea.js"><link rel="prefetch" href="/assets/js/page-LoopController.df96b216.js"><link rel="prefetch" href="/assets/js/page-MySQL.1d60f98f.js"><link rel="prefetch" href="/assets/js/page-MySQL主键和自增ID.af58aff8.js"><link rel="prefetch" href="/assets/js/page-MySQL常用命令.7c04f65a.js"><link rel="prefetch" href="/assets/js/page-MySQL数据库设计规范.7a23aecf.js"><link rel="prefetch" href="/assets/js/page-MySQL数据类型.5ad4a91a.js"><link rel="prefetch" href="/assets/js/page-MySQL的安装与卸载.83cd292c.js"><link rel="prefetch" href="/assets/js/page-MySql事务.b1696ffa.js"><link rel="prefetch" href="/assets/js/page-MySql数据持久化.1af8c064.js"><link rel="prefetch" href="/assets/js/page-MySql锁.ba82e75a.js"><link rel="prefetch" href="/assets/js/page-Nginx.02be0123.js"><link rel="prefetch" href="/assets/js/page-Nginx安全访问控制.81923039.js"><link rel="prefetch" href="/assets/js/page-Nginx常用命令.526f1ae6.js"><link rel="prefetch" href="/assets/js/page-Nginx文件列表功能.698ee4a8.js"><link rel="prefetch" href="/assets/js/page-Nginx的卸载.3990f9fa.js"><link rel="prefetch" href="/assets/js/page-Nginx的安装.ce270546.js"><link rel="prefetch" href="/assets/js/page-Nginx设置开机自启.5ee46c0d.js"><link rel="prefetch" href="/assets/js/page-Nginx部署.fc84eb63.js"><link rel="prefetch" href="/assets/js/page-Nginx部署Https安全认证.4adf92c4.js"><link rel="prefetch" href="/assets/js/page-Nginx部署前后端分离项目.a9c4bc8f.js"><link rel="prefetch" href="/assets/js/page-Nginx限流常用模块.fedbe1b3.js"><link rel="prefetch" href="/assets/js/page-Nginx页面安全认证.38565e63.js"><link rel="prefetch" href="/assets/js/page-Ngixn配置文件模板.0f24b9bb.js"><link rel="prefetch" href="/assets/js/page-Ngixn配置文件详解.b1e3b3f1.js"><link rel="prefetch" href="/assets/js/page-NoSQL.0c93a7ab.js"><link rel="prefetch" href="/assets/js/page-OnceOnly控制器.eb5ae64b.js"><link rel="prefetch" href="/assets/js/page-PEP8.d82c699c.js"><link rel="prefetch" href="/assets/js/page-Pytest+Allure基础使用.5dec7360.js"><link rel="prefetch" href="/assets/js/page-Pytest.8a4bad41.js"><link rel="prefetch" href="/assets/js/page-Pytest生成简单测试报告.4d482548.js"><link rel="prefetch" href="/assets/js/page-Python+Excel+Json+Email框架介绍.ad53b368.js"><link rel="prefetch" href="/assets/js/page-Python内存回收.c04abfaa.js"><link rel="prefetch" href="/assets/js/page-Python反射机制.8b4b60e5.js"><link rel="prefetch" href="/assets/js/page-Python特殊函数.87adc523.js"><link rel="prefetch" href="/assets/js/page-Python简介.6ce1615b.js"><link rel="prefetch" href="/assets/js/page-Random控制器.ab8e4f6d.js"><link rel="prefetch" href="/assets/js/page-Redis.580e6815.js"><link rel="prefetch" href="/assets/js/page-Redis主从复制.3e1ee302.js"><link rel="prefetch" href="/assets/js/page-Redis发布订阅.137c5cf9.js"><link rel="prefetch" href="/assets/js/page-Redis哨兵模式.1aa3e40b.js"><link rel="prefetch" href="/assets/js/page-Restful规范.d420176d.js"><link rel="prefetch" href="/assets/js/page-SQL注入原理.bb43eed0.js"><link rel="prefetch" href="/assets/js/page-SYNFlood攻击.61a3e5f6.js"><link rel="prefetch" href="/assets/js/page-Selenium中xpath定位方式.d1d00b76.js"><link rel="prefetch" href="/assets/js/page-Selenium框架.81b89143.js"><link rel="prefetch" href="/assets/js/page-Selenium等待方式.e3e83346.js"><link rel="prefetch" href="/assets/js/page-Session.1a51b30c.js"><link rel="prefetch" href="/assets/js/page-Set类型.5ffaf07a.js"><link rel="prefetch" href="/assets/js/page-Shell函数.d6d08a67.js"><link rel="prefetch" href="/assets/js/page-Shell参数.3009180d.js"><link rel="prefetch" href="/assets/js/page-Shell变量.17b69a1a.js"><link rel="prefetch" href="/assets/js/page-Shell运算符.8fd9df2f.js"><link rel="prefetch" href="/assets/js/page-Simple控制器.5a544637.js"><link rel="prefetch" href="/assets/js/page-String类型.9a947d6c.js"><link rel="prefetch" href="/assets/js/page-SwitchController.6e72c365.js"><link rel="prefetch" href="/assets/js/page-TCP协议.31c1606d.js"><link rel="prefetch" href="/assets/js/page-TPS与响应时间之间的关系.3858b240.js"><link rel="prefetch" href="/assets/js/page-Term查询语法.d2de6d27.js"><link rel="prefetch" href="/assets/js/page-Token.14a5787a.js"><link rel="prefetch" href="/assets/js/page-UDP协议.a09f6fb3.js"><link rel="prefetch" href="/assets/js/page-While控制器.cee17d8b.js"><link rel="prefetch" href="/assets/js/page-Windows下安装.c3ba8964.js"><link rel="prefetch" href="/assets/js/page-XPath.d062c89f.js"><link rel="prefetch" href="/assets/js/page-XSS.ad7de0e1.js"><link rel="prefetch" href="/assets/js/page-YAML.24922096.js"><link rel="prefetch" href="/assets/js/page-Zset类型.042da44c.js"><link rel="prefetch" href="/assets/js/page-__name__=__main__.5065cf57.js"><link rel="prefetch" href="/assets/js/page-allure命令行参数.afc4098f.js"><link rel="prefetch" href="/assets/js/page-assert断言.4b67471c.js"><link rel="prefetch" href="/assets/js/page-badboy录制脚本.8fb193d3.js"><link rel="prefetch" href="/assets/js/page-clone速度过慢.022323f6.js"><link rel="prefetch" href="/assets/js/page-conftestpy.e2249cca.js"><link rel="prefetch" href="/assets/js/page-copy与deepcopy.ce641ffd.js"><link rel="prefetch" href="/assets/js/page-dockercommit.fbe4834a.js"><link rel="prefetch" href="/assets/js/page-dockercp.8c5d15bf.js"><link rel="prefetch" href="/assets/js/page-dockerexecattach.bcdeebaa.js"><link rel="prefetch" href="/assets/js/page-dockerimages命令.073a24ba.js"><link rel="prefetch" href="/assets/js/page-dockerinspect.866ac75a.js"><link rel="prefetch" href="/assets/js/page-dockerlogs.e978afc7.js"><link rel="prefetch" href="/assets/js/page-dockerps.01a01a40.js"><link rel="prefetch" href="/assets/js/page-dockerpull.747b97f5.js"><link rel="prefetch" href="/assets/js/page-dockerrmi.9fd0404a.js"><link rel="prefetch" href="/assets/js/page-dockerrun.c23138f2.js"><link rel="prefetch" href="/assets/js/page-dockerrun流程和原理.7dce3276.js"><link rel="prefetch" href="/assets/js/page-dockersearch.6209c887.js"><link rel="prefetch" href="/assets/js/page-dockerstartrestart.e1d2fe0d.js"><link rel="prefetch" href="/assets/js/page-dockerstoppause.3d320c14.js"><link rel="prefetch" href="/assets/js/page-dockertop.7f28b7d9.js"><link rel="prefetch" href="/assets/js/page-dockerversioninfo.1dcdd9b0.js"><link rel="prefetch" href="/assets/js/page-docker数据卷.cb8f7692.js"><link rel="prefetch" href="/assets/js/page-docker网络.e70d415f.js"><link rel="prefetch" href="/assets/js/page-fiddler.1d367b63.js"><link rel="prefetch" href="/assets/js/page-fixture.39d92f04.js"><link rel="prefetch" href="/assets/js/page-geospatial地理位置.2aea3af6.js"><link rel="prefetch" href="/assets/js/page-gitpull报错.a93e1076.js"><link rel="prefetch" href="/assets/js/page-gitrebase的两种用法.0845ff1f.js"><link rel="prefetch" href="/assets/js/page-killkillallpkill.492ed069.js"><link rel="prefetch" href="/assets/js/page-list类型.61cd781f.js"><link rel="prefetch" href="/assets/js/page-logging日志重复输出.ab13793b.js"><link rel="prefetch" href="/assets/js/page-oswalk().61460a52.js"><link rel="prefetch" href="/assets/js/page-params.137835fb.js"><link rel="prefetch" href="/assets/js/page-pip安装和应用.26cddece.js"><link rel="prefetch" href="/assets/js/page-property属性.5dfe5b59.js"><link rel="prefetch" href="/assets/js/page-pull时发现代码冲突，如何解决.0b3ca407.js"><link rel="prefetch" href="/assets/js/page-pytest-assume.6174770f.js"><link rel="prefetch" href="/assets/js/page-pytest-html.da333fcd.js"><link rel="prefetch" href="/assets/js/page-pytest-repeat.057e983b.js"><link rel="prefetch" href="/assets/js/page-pytest-rerunfailures.c74bda4a.js"><link rel="prefetch" href="/assets/js/page-pytest-xdist.a81c4ff4.js"><link rel="prefetch" href="/assets/js/page-pytest-xdist分布式测试的原理.6b1bf7a0.js"><link rel="prefetch" href="/assets/js/page-pytestini配置文件.5df31a1e.js"><link rel="prefetch" href="/assets/js/page-redisconf详解.7bfd49be.js"><link rel="prefetch" href="/assets/js/page-request.c476f3b7.js"><link rel="prefetch" href="/assets/js/page-scope.454da135.js"><link rel="prefetch" href="/assets/js/page-selenium定位方式.a68f9c72.js"><link rel="prefetch" href="/assets/js/page-setup与teardown.de50d56d.js"><link rel="prefetch" href="/assets/js/page-skipskipif.572b970a.js"><link rel="prefetch" href="/assets/js/page-sort与sorted.763e4660.js"><link rel="prefetch" href="/assets/js/page-venv.c144f2d2.js"><link rel="prefetch" href="/assets/js/page-watch监控.a9c3c711.js"><link rel="prefetch" href="/assets/js/page-《刻意练习》.233c8a91.js"><link rel="prefetch" href="/assets/js/page-《掌控习惯》.0d1b7e16.js"><link rel="prefetch" href="/assets/js/page-《数据思维》.bd1c947d.js"><link rel="prefetch" href="/assets/js/page-《游戏改变世界》.cdde8da3.js"><link rel="prefetch" href="/assets/js/page-《终结拖延症》.d728377a.js"><link rel="prefetch" href="/assets/js/page-《终身成长》.6c919610.js"><link rel="prefetch" href="/assets/js/page-三种状态机制.ee3408c2.js"><link rel="prefetch" href="/assets/js/page-了解性能.8f0fe6cd.js"><link rel="prefetch" href="/assets/js/page-事务.448683bc.js"><link rel="prefetch" href="/assets/js/page-互联网产品如何设计测试策略.470b30ff.js"><link rel="prefetch" href="/assets/js/page-产品.a5f8829a.js"><link rel="prefetch" href="/assets/js/page-代码级测试方法.6cb76f56.js"><link rel="prefetch" href="/assets/js/page-作用域.afcfce7e.js"><link rel="prefetch" href="/assets/js/page-使用Fabric执行SSH.017f2f09.js"><link rel="prefetch" href="/assets/js/page-使用Jenkins构建Pytest项目生成Allure报告.0399d23b.js"><link rel="prefetch" href="/assets/js/page-使用logging输出日志信息.a45805a1.js"><link rel="prefetch" href="/assets/js/page-使用openpyxl处理新版本Excel.fd6e3238.js"><link rel="prefetch" href="/assets/js/page-使用smtplib发送电子邮件.211e9fc9.js"><link rel="prefetch" href="/assets/js/page-使用xlrd处理旧版本Excel.d4d2182f.js"><link rel="prefetch" href="/assets/js/page-修改commit信息.d401bfe7.js"><link rel="prefetch" href="/assets/js/page-偷偷@你，炸鸡分享桶，可得99现金券案例.f0b509f2.js"><link rel="prefetch" href="/assets/js/page-元类.0efba911.js"><link rel="prefetch" href="/assets/js/page-全文搜索语法.dd934fea.js"><link rel="prefetch" href="/assets/js/page-关键字驱动设计.c0a0ee64.js"><link rel="prefetch" href="/assets/js/page-函数.30a7de55.js"><link rel="prefetch" href="/assets/js/page-分组查询语法.aa5a1fe0.js"><link rel="prefetch" href="/assets/js/page-分词器的原理和使用.4c593776.js"><link rel="prefetch" href="/assets/js/page-刚刚的commit有误，想要撤回.417d4ad6.js"><link rel="prefetch" href="/assets/js/page-刚刚的push有误，想要撤回.11a5effe.js"><link rel="prefetch" href="/assets/js/page-单实例模式.5e2f678d.js"><link rel="prefetch" href="/assets/js/page-团建总结.274451af.js"><link rel="prefetch" href="/assets/js/page-基本命令.9d5c23e2.js"><link rel="prefetch" href="/assets/js/page-多线程.5cd5074a.js"><link rel="prefetch" href="/assets/js/page-大型项目GUI自动化测试设计策略.06e2732f.js"><link rel="prefetch" href="/assets/js/page-如何使用GitFlow工作流进行团队协作.ff03e56a.js"><link rel="prefetch" href="/assets/js/page-如何修改历史commits中的用户名和邮箱.b00b10a1.js"><link rel="prefetch" href="/assets/js/page-如何做好测试计划.3e22a574.js"><link rel="prefetch" href="/assets/js/page-如何写总结.8d61c678.js"><link rel="prefetch" href="/assets/js/page-如何参与开源项目-提交PR与更新Fork分支.00761740.js"><link rel="prefetch" href="/assets/js/page-如何设计一个「好的」测试用例.4ed23137.js"><link rel="prefetch" href="/assets/js/page-如何迁移仓库并保留commits记录.2bfcd03c.js"><link rel="prefetch" href="/assets/js/page-如何进行场景设计.f91dee9e.js"><link rel="prefetch" href="/assets/js/page-如何高效填写缺陷.242a5344.js"><link rel="prefetch" href="/assets/js/page-子查询语法.00685700.js"><link rel="prefetch" href="/assets/js/page-子网掩码.4573d188.js"><link rel="prefetch" href="/assets/js/page-安装Redis.e3ad9a9c.js"><link rel="prefetch" href="/assets/js/page-安装监听器插件.69d29f3f.js"><link rel="prefetch" href="/assets/js/page-定义字段类型：Mapping.dab916ce.js"><link rel="prefetch" href="/assets/js/page-嵌套类型和父子文档.6ec65de9.js"><link rel="prefetch" href="/assets/js/page-工具仅是工具.5c392dbc.js"><link rel="prefetch" href="/assets/js/page-已commit未push，想修改代码.1658d4f2.js"><link rel="prefetch" href="/assets/js/page-已commit未push，漏提交文件.7324ef01.js"><link rel="prefetch" href="/assets/js/page-常用命令清单.b6715c41.js"><link rel="prefetch" href="/assets/js/page-常用文件查看命令.474ac207.js"><link rel="prefetch" href="/assets/js/page-常用目录操作命令.344cfefb.js"><link rel="prefetch" href="/assets/js/page-常见测试点.5df2bc8b.js"><link rel="prefetch" href="/assets/js/page-幸福的方法.a777a7c1.js"><link rel="prefetch" href="/assets/js/page-库和表的基本操作.fb215903.js"><link rel="prefetch" href="/assets/js/page-异常处理.08a2eec6.js"><link rel="prefetch" href="/assets/js/page-循环.f8bdbf5f.js"><link rel="prefetch" href="/assets/js/page-循环控制.50494f0a.js"><link rel="prefetch" href="/assets/js/page-微服务下的API测试.18377a9b.js"><link rel="prefetch" href="/assets/js/page-必备知识.93eb76d1.js"><link rel="prefetch" href="/assets/js/page-性能分析思路.9cf1dbc3.js"><link rel="prefetch" href="/assets/js/page-性能指标理解.9ab5d5fd.js"><link rel="prefetch" href="/assets/js/page-性能测试基础.d6fd0753.js"><link rel="prefetch" href="/assets/js/page-性能测试概念.0f0cf8ad.js"><link rel="prefetch" href="/assets/js/page-性能调优.f9e50922.js"><link rel="prefetch" href="/assets/js/page-性能面试题2.e733f39b.js"><link rel="prefetch" href="/assets/js/page-技能相关.b116ed97.js"><link rel="prefetch" href="/assets/js/page-抓取HTTPS设置.b3698b70.js"><link rel="prefetch" href="/assets/js/page-抓取手机端数据包设置.8899dd4c.js"><link rel="prefetch" href="/assets/js/page-持久化之AOF.ad93b6ff.js"><link rel="prefetch" href="/assets/js/page-持久化之RBD.4eb638f7.js"><link rel="prefetch" href="/assets/js/page-接口测试基础.59cbc86b.js"><link rel="prefetch" href="/assets/js/page-推导式.1e10ced1.js"><link rel="prefetch" href="/assets/js/page-提高GUI测试稳定性.228a83a4.js"><link rel="prefetch" href="/assets/js/page-搜索词自动补全语法.9b0b6367.js"><link rel="prefetch" href="/assets/js/page-数据的增删改.05aa6441.js"><link rel="prefetch" href="/assets/js/page-数据类型.4da8eab7.js"><link rel="prefetch" href="/assets/js/page-数据驱动.b3e52a9d.js"><link rel="prefetch" href="/assets/js/page-文件打包与压缩.289ee339.js"><link rel="prefetch" href="/assets/js/page-文档基本操作.81f599e7.js"><link rel="prefetch" href="/assets/js/page-断点.7352897f.js"><link rel="prefetch" href="/assets/js/page-更改默认pip下载源.374f96a1.js"><link rel="prefetch" href="/assets/js/page-更新日志.91dbe4c2.js"><link rel="prefetch" href="/assets/js/page-权限操作.b1c0a012.js"><link rel="prefetch" href="/assets/js/page-条件查询语法.c7b2a490.js"><link rel="prefetch" href="/assets/js/page-枚举.c0e5937d.js"><link rel="prefetch" href="/assets/js/page-查看端口占用情况.8f124a21.js"><link rel="prefetch" href="/assets/js/page-正则提取器.1c9124cf.js"><link rel="prefetch" href="/assets/js/page-正则简介.3fac4f28.js"><link rel="prefetch" href="/assets/js/page-正向代理与反向代理.990a4661.js"><link rel="prefetch" href="/assets/js/page-正排索引与倒排索引.6f5c03d0.js"><link rel="prefetch" href="/assets/js/page-流程控制.db8498d7.js"><link rel="prefetch" href="/assets/js/page-测试基础篇.ac4d1726.js"><link rel="prefetch" href="/assets/js/page-测试工程师核心竞争力.df076236.js"><link rel="prefetch" href="/assets/js/page-测试覆盖率.0a1f5fe3.js"><link rel="prefetch" href="/assets/js/page-测试计划.0eb0c916.js"><link rel="prefetch" href="/assets/js/page-测试计划参数详解.1cda3d24.js"><link rel="prefetch" href="/assets/js/page-深入浅出静态方法.af186df0.js"><link rel="prefetch" href="/assets/js/page-环境准备与入门.d9594a69.js"><link rel="prefetch" href="/assets/js/page-生成器.d4aca914.js"><link rel="prefetch" href="/assets/js/page-用户参数.b044ad54.js"><link rel="prefetch" href="/assets/js/page-用户登录.e231a04f.js"><link rel="prefetch" href="/assets/js/page-用户组管理.029d4523.js"><link rel="prefetch" href="/assets/js/page-用户自定义的变量.5e55a667.js"><link rel="prefetch" href="/assets/js/page-目录介绍.b029d2af.js"><link rel="prefetch" href="/assets/js/page-移动应用测试方法与思路.0a1178e7.js"><link rel="prefetch" href="/assets/js/page-移动面试题.44ef62dc.js"><link rel="prefetch" href="/assets/js/page-第三选择.e89de49d.js"><link rel="prefetch" href="/assets/js/page-简单查询语法.fc270277.js"><link rel="prefetch" href="/assets/js/page-简历编写和面试技巧.e2a9b603.js"><link rel="prefetch" href="/assets/js/page-管理十戒.df8808a3.js"><link rel="prefetch" href="/assets/js/page-类与实例.296859f7.js"><link rel="prefetch" href="/assets/js/page-索引.6a4493cb.js"><link rel="prefetch" href="/assets/js/page-索引管理API.480af360.js"><link rel="prefetch" href="/assets/js/page-索引结构.46ac43a1.js"><link rel="prefetch" href="/assets/js/page-线程组.a74c337b.js"><link rel="prefetch" href="/assets/js/page-组合查询语法.3ce845f3.js"><link rel="prefetch" href="/assets/js/page-统计语法：聚合查询.7a48de8d.js"><link rel="prefetch" href="/assets/js/page-继承.1876274e.js"><link rel="prefetch" href="/assets/js/page-缓存穿透与雪崩.9899e5ad.js"><link rel="prefetch" href="/assets/js/page-编程题.86531911.js"><link rel="prefetch" href="/assets/js/page-网络分层模型.adacf849.js"><link rel="prefetch" href="/assets/js/page-网络基础.1cd5b1c5.js"><link rel="prefetch" href="/assets/js/page-聚簇索引与非聚簇索引.6657507f.js"><link rel="prefetch" href="/assets/js/page-能力陷阱.873ebbe3.js"><link rel="prefetch" href="/assets/js/page-自动化测试.aa7d7daa.js"><link rel="prefetch" href="/assets/js/page-自动化理解及应用场景.18b4eea1.js"><link rel="prefetch" href="/assets/js/page-自动化面试题1.c1e3d41a.js"><link rel="prefetch" href="/assets/js/page-自定义mark.194d3c8d.js"><link rel="prefetch" href="/assets/js/page-表中列的基本属性.7f86c070.js"><link rel="prefetch" href="/assets/js/page-表达式和函数.987dd07c.js"><link rel="prefetch" href="/assets/js/page-装饰器.0e911f0b.js"><link rel="prefetch" href="/assets/js/page-规范.621a485f.js"><link rel="prefetch" href="/assets/js/page-解决Jenkins执行找不到pytest命令.65821f36.js"><link rel="prefetch" href="/assets/js/page-认知天性.cbc5c925.js"><link rel="prefetch" href="/assets/js/page-语法.52b72c4b.js"><link rel="prefetch" href="/assets/js/page-请求后断点应用.e0786efb.js"><link rel="prefetch" href="/assets/js/page-读书笔记.483cfcf0.js"><link rel="prefetch" href="/assets/js/page-负载均衡.77643748.js"><link rel="prefetch" href="/assets/js/page-账号管理.4eb8d570.js"><link rel="prefetch" href="/assets/js/page-跨域.f63c7472.js"><link rel="prefetch" href="/assets/js/page-进程.3d39e55b.js"><link rel="prefetch" href="/assets/js/page-连接查询语法.d3a77c19.js"><link rel="prefetch" href="/assets/js/page-迭代器.4b09487a.js"><link rel="prefetch" href="/assets/js/page-配置密钥实现免密操作.2dbac1ec.js"><link rel="prefetch" href="/assets/js/page-配置文件.3b4bbe81.js"><link rel="prefetch" href="/assets/js/page-配置镜像加速.b416d5ec.js"><link rel="prefetch" href="/assets/js/page-镜像原理.e89dd547.js"><link rel="prefetch" href="/assets/js/page-闭包.31dc4cd2.js"><link rel="prefetch" href="/assets/js/page-问题记录.0091353b.js"><link rel="prefetch" href="/assets/js/page-集群管理API.72b0df1b.js"><link rel="prefetch" href="/assets/js/page-面试心理学.cb793515.js"><link rel="prefetch" href="/assets/js/page-面试技巧.c5846738.js"><link rel="prefetch" href="/assets/js/page-面试相关.bb829ea3.js"><link rel="prefetch" href="/assets/js/page-页面对象（PageObject）模型.ef0c411b.js"><link rel="prefetch" href="/assets/js/vendors~layout-Slide.0659ad8d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b5f89971.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container has-navbar has-sidebar has-anchor"><header class="navbar"><!----> <div class="content__navbar-start"></div> <button title="Sidebar Button" class="sidebar-button"><span class="icon"></span></button> <a href="/" class="home-link router-link-active"><img src="/img/snow.png" alt="测试开发手册" class="logo"> <!----> <span class="site-name can-hide">测试开发手册</span></a> <!----> <div class="content__navbar-center"></div> <div class="links"><!----> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="测试相关" class="dropdown-title"><span class="title"><!---->
        测试相关
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>理论知识</span></h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/test/theory/basic-essentials/" class="nav-link"><!---->
  测试基础
</a></li><li class="dropdown-subitem"><a href="/test/theory/interface-test/" class="nav-link"><!---->
  接口测试
</a></li><li class="dropdown-subitem"><a href="/test/theory/auto-test/" class="nav-link"><!---->
  自动化测试
</a></li><li class="dropdown-subitem"><a href="/test/theory/performance-test/" class="nav-link"><!---->
  性能测试
</a></li><li class="dropdown-subitem"><a href="/test/theory/safety-test/" class="nav-link"><!---->
  安全测试
</a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>测试框架</span></h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/test/frameworks/selenium/selenium-theory/" class="nav-link"><!---->
  Selenium
</a></li><li class="dropdown-subitem"><a href="/test/frameworks/pytest/" class="nav-link"><!---->
  Pytest
</a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>测试工具</span></h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/test/tools/Jmeter/" class="nav-link"><!---->
  Jmeter
</a></li><li class="dropdown-subitem"><a href="/test/tools/fiddler/" class="nav-link"><!---->
  fiddler
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="必知必会" class="dropdown-title"><span class="title"><!---->
        必知必会
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>基础知识</span></h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/basic-skills/linux/" class="nav-link"><!---->
  Linux
</a></li><li class="dropdown-subitem"><a href="/basic-skills/network/" class="nav-link"><!---->
  计算机网络
</a></li><li class="dropdown-subitem"><a href="/basic-skills/regular/" class="nav-link"><!---->
  正则表达式
</a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>常用工具</span></h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/basic-skills/git/" class="nav-link"><!---->
  Git
</a></li><li class="dropdown-subitem"><a href="/basic-skills/nginx/" class="nav-link"><!---->
  Nginx
</a></li><li class="dropdown-subitem"><a href="/basic-skills/docker/" class="nav-link"><!---->
  Docker
</a></li><li class="dropdown-subitem"><a href="/basic-skills/Jenkins/" class="nav-link"><!---->
  Jenkins
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程语言" class="dropdown-title"><span class="title"><!---->
        编程语言
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/languages/python/basics/" class="nav-link"><!---->
  Python
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据存储" class="dropdown-title"><span class="title"><!---->
        数据存储
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/databases/mysql/installation-of-mysql.html" class="nav-link"><!---->
  MySQL
</a></li><li class="dropdown-item"><a href="/databases/redis/nosql.html" class="nav-link"><!---->
  Redis
</a></li><li class="dropdown-item"><a href="/databases/es/windows.html" class="nav-link"><!---->
  Elasticsearch
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="项目相关" class="dropdown-title"><span class="title"><!---->
        项目相关
      </span> <span class="arrow"></span></button> <ul class="nav-dropdown"><li class="dropdown-item"><a href="/project/problems/" class="nav-link"><!---->
  问题记录
</a></li></ul></div></div></nav> <!----> <!----> <!----> <div class="content__navbar-end"></div></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!----> <!----> <div class="content__sidebar-top"></div> <nav class="sidebar-nav-links"><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="测试相关" class="dropdown-title"><span class="title"><!---->
      测试相关
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>理论知识</span></h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/test/theory/basic-essentials/" class="nav-link"><!---->
  测试基础
</a></li><li class="dropdown-subitem"><a href="/test/theory/interface-test/" class="nav-link"><!---->
  接口测试
</a></li><li class="dropdown-subitem"><a href="/test/theory/auto-test/" class="nav-link"><!---->
  自动化测试
</a></li><li class="dropdown-subitem"><a href="/test/theory/performance-test/" class="nav-link"><!---->
  性能测试
</a></li><li class="dropdown-subitem"><a href="/test/theory/safety-test/" class="nav-link"><!---->
  安全测试
</a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>测试框架</span></h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/test/frameworks/selenium/selenium-theory/" class="nav-link"><!---->
  Selenium
</a></li><li class="dropdown-subitem"><a href="/test/frameworks/pytest/" class="nav-link"><!---->
  Pytest
</a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>测试工具</span></h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/test/tools/Jmeter/" class="nav-link"><!---->
  Jmeter
</a></li><li class="dropdown-subitem"><a href="/test/tools/fiddler/" class="nav-link"><!---->
  fiddler
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="必知必会" class="dropdown-title"><span class="title"><!---->
      必知必会
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>基础知识</span></h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/basic-skills/linux/" class="nav-link"><!---->
  Linux
</a></li><li class="dropdown-subitem"><a href="/basic-skills/network/" class="nav-link"><!---->
  计算机网络
</a></li><li class="dropdown-subitem"><a href="/basic-skills/regular/" class="nav-link"><!---->
  正则表达式
</a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>常用工具</span></h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/basic-skills/git/" class="nav-link"><!---->
  Git
</a></li><li class="dropdown-subitem"><a href="/basic-skills/nginx/" class="nav-link"><!---->
  Nginx
</a></li><li class="dropdown-subitem"><a href="/basic-skills/docker/" class="nav-link"><!---->
  Docker
</a></li><li class="dropdown-subitem"><a href="/basic-skills/Jenkins/" class="nav-link"><!---->
  Jenkins
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="编程语言" class="dropdown-title"><span class="title"><!---->
      编程语言
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/languages/python/basics/" class="nav-link"><!---->
  Python
</a></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="数据存储" class="dropdown-title"><span class="title"><!---->
      数据存储
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/databases/mysql/installation-of-mysql.html" class="nav-link"><!---->
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/databases/redis/nosql.html" class="nav-link"><!---->
  Redis
</a></li><li class="dropdown-item"><!----> <a href="/databases/es/windows.html" class="nav-link"><!---->
  Elasticsearch
</a></li></ul></div></div><div class="nav-item"><div class="mobile-dropdown-wrapper"><button type="button" aria-label="项目相关" class="dropdown-title"><span class="title"><!---->
      项目相关
    </span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/project/problems/" class="nav-link"><!---->
  问题记录
</a></li></ul></div></div> <!----></nav> <!----> <div class="content__sidebar-center"></div> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><!----> <span class="title">Redis 基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/databases/redis/nosql/" class="sidebar-link">了解 NoSQL</a></li><li><a href="/databases/redis/redis-basic/" class="sidebar-link">初识 Redis</a></li><li><a href="/databases/redis/redis-install/" class="sidebar-link">安装 Redis</a></li><li><a href="/databases/redis/config/" class="sidebar-link">redis.conf 配置文件详解</a></li><li><a href="/databases/redis/basic-commands/" class="sidebar-link">Redis 基本命令</a></li><li><a href="/databases/redis/string/" class="sidebar-link">Redis 类型之 String</a></li><li><a href="/databases/redis/list/" class="sidebar-link">Redis 类型之 List</a></li><li><a href="/databases/redis/set/" class="sidebar-link">Redis 类型之 Set</a></li><li><a href="/databases/redis/Hash/" class="sidebar-link">Redis 类型之 Hash</a></li><li><a href="/databases/redis/zset/" class="sidebar-link">Redis 类型之 Zset</a></li><li><a href="/databases/redis/geospatial/" class="sidebar-link">Redis 地理位置 Geospatial</a></li><li><a href="/databases/redis/hyperloglog/" class="sidebar-link">Redis 基数统计 Hyperloglog</a></li><li><a href="/databases/redis/BitMaps/" class="sidebar-link">Redis 位图 BitMap</a></li><li><a href="/databases/redis/affairs/" class="sidebar-link">Redis 事务</a></li><li><a href="/databases/redis/watch/" class="sidebar-link">Redis 使用 watch 实现乐观锁</a></li><li><a href="/databases/redis/rdb/" class="sidebar-link">Redis 持久化之 RDB</a></li><li><a href="/databases/redis/aof/" class="sidebar-link">Redis 持久化之 AOF</a></li><li><a href="/databases/redis/subscribe/" class="sidebar-link">Redis 发布订阅</a></li><li><a href="/databases/redis/master-slave/" class="sidebar-link">Redis 主从复制</a></li><li><a href="/databases/redis/sentinel/" class="sidebar-link">Redis 哨兵模式</a></li><li><a href="/databases/redis/cache/" class="sidebar-link">Redis 缓存三大问题</a></li><li><a href="/databases/redis/access-control-list/" aria-current="page" class="active sidebar-link">Redis 的 ACL 安全策略</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/databases/redis/access-control-list/#背景" class="sidebar-link">背景</a></li><li class="sidebar-sub-header"><a href="/databases/redis/access-control-list/#acl-简介" class="sidebar-link">ACL 简介</a></li><li class="sidebar-sub-header"><a href="/databases/redis/access-control-list/#配置-acl" class="sidebar-link">配置 ACL</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/databases/redis/access-control-list/#dsl-语法" class="sidebar-link heading3">DSL 语法</a></li><li class="sidebar-sub-header"><a href="/databases/redis/access-control-list/#使用-conf-配置-acl" class="sidebar-link heading3">使用 conf 配置 ACL</a></li><li class="sidebar-sub-header"><a href="/databases/redis/access-control-list/#使用外部-aclfile-配置-acl" class="sidebar-link heading3">使用外部 aclfile 配置 ACL</a></li><li class="sidebar-sub-header"><a href="/databases/redis/access-control-list/#对比-conf-和-aclfile-两种方式" class="sidebar-link heading3">对比 conf 和 aclfile 两种方式</a></li></ul></li><li class="sidebar-sub-header"><a href="/databases/redis/access-control-list/#通过命令行来管理用户" class="sidebar-link">通过命令行来管理用户</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/databases/redis/access-control-list/#持久化的方式" class="sidebar-link heading3">持久化的方式</a></li><li class="sidebar-sub-header"><a href="/databases/redis/access-control-list/#增删改查用户" class="sidebar-link heading3">增删改查用户</a></li><li class="sidebar-sub-header"><a href="/databases/redis/access-control-list/#登录和切换指定用户" class="sidebar-link heading3">登录和切换指定用户</a></li><li class="sidebar-sub-header"><a href="/databases/redis/access-control-list/#热加载命令" class="sidebar-link heading3">热加载命令</a></li><li class="sidebar-sub-header"><a href="/databases/redis/access-control-list/#持久化命令" class="sidebar-link heading3">持久化命令</a></li><li class="sidebar-sub-header"><a href="/databases/redis/access-control-list/#查看命令类别-用于授权" class="sidebar-link heading3">查看命令类别，用于授权</a></li><li class="sidebar-sub-header"><a href="/databases/redis/access-control-list/#其他常用-acl-命令" class="sidebar-link heading3">其他常用 ACL 命令</a></li></ul></li><li class="sidebar-sub-header"><a href="/databases/redis/access-control-list/#acl-规则" class="sidebar-link">ACL 规则</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/databases/redis/access-control-list/#启用和禁用用户" class="sidebar-link heading3">启用和禁用用户</a></li><li class="sidebar-sub-header"><a href="/databases/redis/access-control-list/#允许和禁止调用命令" class="sidebar-link heading3">允许和禁止调用命令</a></li><li class="sidebar-sub-header"><a href="/databases/redis/access-control-list/#允许和禁止访问某些-key" class="sidebar-link heading3">允许和禁止访问某些 Key</a></li><li class="sidebar-sub-header"><a href="/databases/redis/access-control-list/#为用户配置有效密码" class="sidebar-link heading3">为用户配置有效密码</a></li></ul></li><li class="sidebar-sub-header"><a href="/databases/redis/access-control-list/#参考文档" class="sidebar-link">参考文档</a></li></ul></li></ul></section></li></ul> <!----> <div class="content__sidebar-bottom"></div> <!----></aside> <main class="page"><nav class="breadcrumb disable"><!----></nav> <!----> <div class="content__page-top"></div> <div vocab="https://schema.org/" typeof="Article" class="page-title"><h1><!----> <span property="headline">Redis 的 ACL 安全策略</span></h1> <!----> <!----> <hr></div> <div class="anchor-place-holder"><aside id="anchor"><div class="anchor-wrapper"><ul class="anchor-list"><li class="anchor"><a href="/databases/redis/access-control-list/#背景" class="anchor-link heading2"><div>背景</div></a></li><li class="anchor"><a href="/databases/redis/access-control-list/#acl-简介" class="anchor-link heading2"><div>ACL 简介</div></a></li><li class="anchor"><a href="/databases/redis/access-control-list/#配置-acl" class="anchor-link heading2"><div>配置 ACL</div></a></li><li class="anchor"><a href="/databases/redis/access-control-list/#dsl-语法" class="anchor-link heading3"><div>DSL 语法</div></a></li><li class="anchor"><a href="/databases/redis/access-control-list/#使用-conf-配置-acl" class="anchor-link heading3"><div>使用 conf 配置 ACL</div></a></li><li class="anchor"><a href="/databases/redis/access-control-list/#使用外部-aclfile-配置-acl" class="anchor-link heading3"><div>使用外部 aclfile 配置 ACL</div></a></li><li class="anchor"><a href="/databases/redis/access-control-list/#对比-conf-和-aclfile-两种方式" class="anchor-link heading3"><div>对比 conf 和 aclfile 两种方式</div></a></li><li class="anchor"><a href="/databases/redis/access-control-list/#通过命令行来管理用户" class="anchor-link heading2"><div>通过命令行来管理用户</div></a></li><li class="anchor"><a href="/databases/redis/access-control-list/#持久化的方式" class="anchor-link heading3"><div>持久化的方式</div></a></li><li class="anchor"><a href="/databases/redis/access-control-list/#增删改查用户" class="anchor-link heading3"><div>增删改查用户</div></a></li><li class="anchor"><a href="/databases/redis/access-control-list/#登录和切换指定用户" class="anchor-link heading3"><div>登录和切换指定用户</div></a></li><li class="anchor"><a href="/databases/redis/access-control-list/#热加载命令" class="anchor-link heading3"><div>热加载命令</div></a></li><li class="anchor"><a href="/databases/redis/access-control-list/#持久化命令" class="anchor-link heading3"><div>持久化命令</div></a></li><li class="anchor"><a href="/databases/redis/access-control-list/#查看命令类别-用于授权" class="anchor-link heading3"><div>查看命令类别，用于授权</div></a></li><li class="anchor"><a href="/databases/redis/access-control-list/#其他常用-acl-命令" class="anchor-link heading3"><div>其他常用 ACL 命令</div></a></li><li class="anchor"><a href="/databases/redis/access-control-list/#acl-规则" class="anchor-link heading2"><div>ACL 规则</div></a></li><li class="anchor"><a href="/databases/redis/access-control-list/#启用和禁用用户" class="anchor-link heading3"><div>启用和禁用用户</div></a></li><li class="anchor"><a href="/databases/redis/access-control-list/#允许和禁止调用命令" class="anchor-link heading3"><div>允许和禁止调用命令</div></a></li><li class="anchor"><a href="/databases/redis/access-control-list/#允许和禁止访问某些-key" class="anchor-link heading3"><div>允许和禁止访问某些 Key</div></a></li><li class="anchor"><a href="/databases/redis/access-control-list/#为用户配置有效密码" class="anchor-link heading3"><div>为用户配置有效密码</div></a></li><li class="anchor"><a href="/databases/redis/access-control-list/#参考文档" class="anchor-link heading2"><div>参考文档</div></a></li></ul></div></aside></div> <!----> <div class="content__content-top"></div> <div class="theme-default-content content__default"><h1 id="redis-的-acl-安全策略"><a href="#redis-的-acl-安全策略" class="header-anchor">#</a> Redis 的 ACL 安全策略</h1> <blockquote><p>ACL 是 Redis 6.0 的新特性，主要是做权限控制的</p> <p>它的出现是因为在 Redis 6.0 版本之前是没有权限的概念的，所有连接的客户端都可以对 Redis 里面的数据进行操作，也可以使用所有高危命令，比如 <code>flushall</code> 或 <code>flushdb</code> 清空掉数据库里面的所有数据</p></blockquote> <h2 id="背景"><a href="#背景" class="header-anchor">#</a> 背景</h2> <p>最近给新安装的 Redis 设置密码时，按照以前的方式，因为在 Redis 6.0 之前，Redis 只有一个 default 用户也是 Redis 中的超级管理员用户，所以要将其设置密码，只需要修改 Redis 配置文件中如下项：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>requirepass <span class="token number">123456</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>然后重启 Redis 就可以了。</p> <p>这就是在 Redis 6.0 之前给 Redis 用户创建密码的方式，只有一个 <code>default</code> 用户也是 Redis 中的超级管理员用户</p> <p>但是这次安装的是 Redis 7，在一次开启公网调试并用代码访问时，发现通过配置文件设置的密码并未生效。又重新看了下配置文件，果然在这一项的上面注释中写着：<code>requirepass</code> 与 ACL 不兼容，如果开启了 ACL，那么这项配置将被忽略</p> <p>看来有必要了解一下 ACL 这个新特性了</p> <h2 id="acl-简介"><a href="#acl-简介" class="header-anchor">#</a> ACL 简介</h2> <p>在 Redis 6.0 之前的版本，我们只能使用 <code>requirepass</code> 参数给 <code>default</code> 用户配置登录密码，同一个 Redis 集群的所有开发都共享 <code>default</code> 用户，难免会出现误操作把别人的 key 删掉或者数据泄露的情况</p> <p>因此 Redis 6.0 版本推出了 ACL（Access Controller List）访问控制权限的功能，基于此功能，我们可以设置多个用户，并且给每个用户单独设置命令权限和数据权限。在用户连接之后，它的工作方式是需要客户端进行身份验证，以提供用户名和有效密码：如果身份验证阶段成功，则连接与给定用户关联，并且该用户具有限制</p> <p>为了保证向下兼容，Redis 6.0 保留了 <code>default</code> 用户和使用 <code>requirepass</code> 的方式给 <code>default</code> 用户设置密码，默认情况下 <code>default</code> 用户拥有 Redis 最大权限，我们使用 redis-cli 连接时如果没有指定用户名，用户也是默认 <code>default</code></p> <h2 id="配置-acl"><a href="#配置-acl" class="header-anchor">#</a> 配置 ACL</h2> <p>配置 ACL 的方式有两种，一种是在 conf 文件中直接配置，另一种是在外部 aclfile 中配置。配置的命令是一样的，<strong>但是两种方式只能选择其中一种</strong></p> <p>在讲具体的配置方式之前，需要先简单介绍一下定义 ACL 时用到的 DSL 语法</p> <h3 id="dsl-语法"><a href="#dsl-语法" class="header-anchor">#</a> DSL 语法</h3> <p>ACL 是使用 DSL 定义的，该 DSL 就是一个规则，描述了指定用户可以执行的操作，且是按照从左到右、从第一个到最后一个的顺序实施，因为有时规则的顺序对于理解用户的实际能力很重要</p> <div class="custom-block tip"><p class="custom-block-title">小贴士</p> <p>DSL（domain specific language）是领域专用语言，其基本思想是「求专不求全」，不像通用目的语言那样目标范围涵盖一切软件问题，而是具有受限的表达，专门针对某一特定问题的计算机语言</p> <ul><li>Java、Python、C 都是通用性编程语言，也就是我们可以用于多个不同的领域，普通应用编程</li> <li>HTML、SQL 都算得上是领域专用语言，需要寄生在宿主语言中。比如 React 或者 Vue 支持的 JSX 语法都属于 DSL，「寄生」于前端 HTML 中</li></ul></div> <p>以查看默认用户的 ACL 为例，默认情况下，只有一个用户定义，称为 <code>default</code>。我们可以使用 <a href="https://redis.io/commands/acl-list/" target="_blank" rel="noopener noreferrer"><code>ACL LIST</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 命令来检查当前活动的 ACL 并验证新启动的，默认的 Redis 实例的配置是：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@VM-16-7-centos ~<span class="token punctuation">]</span><span class="token comment"># redis-cli -h 127.0.0.1 -p 6379</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> acl list
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;user default on nopass sanitize-payload ~* &amp;* +@all&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>解释一下返回值：</p> <ul><li>第一个是固定单词 <code>user</code>，后面跟上用户名（此处是 <code>default</code>）</li> <li>默认用户已配置为活动状态（<code>on</code>），不需要密码（<code>nopass</code>）</li> <li>权限是访问所有可能的键（<code>~*</code>）和 发布/订阅（Pub/Sub）频道（<code>&amp;*</code>），并能够调用所有可能的命令（<code>+@all</code>）</li></ul> <p>对于这个默认用户，具有 <code>nopass</code> 规则意味着新连接将自动与默认用户进行身份验证，而无需任何显式的 auth 调用</p> <p>至于 ACL 规则用 DSL 怎么写，最后再讲，现在有个大概的概念就行。下面展开来讲两种配置方式</p> <h3 id="使用-conf-配置-acl"><a href="#使用-conf-配置-acl" class="header-anchor">#</a> 使用 conf 配置 ACL</h3> <p>我们之前使用 <code>requirepass</code> 给 <code>default</code> 用户设置密码默认就是使用的 conf 方式。并且 6.0 版本开始，在用之前方式给 <code>default</code> 用户配置密码后，再执行 <code>config rewrite</code> 重写配置，就会自动在 conf 文件最下面新增一行记录来配置 <code>default</code> 的密码和权限</p> <p>使用 conf 文件配置 default 和其他用户的 ACL 权限，操作步骤如下：</p> <h4 id="_1-第一步-在-conf-文件中配置-default-用户的密码"><a href="#_1-第一步-在-conf-文件中配置-default-用户的密码" class="header-anchor">#</a> 1）第一步，在 conf 文件中配置 <code>default</code> 用户的密码</h4> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># The requirepass is not compatible with aclfile option and the ACL LOAD</span>
<span class="token comment"># command, these will cause requirepass to be ignored.</span>
<span class="token comment">#</span>
requirepass <span class="token number">123456</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="_2-第二步-重启-redis-服务-进入命令行执行-config-rewrite-命令"><a href="#_2-第二步-重启-redis-服务-进入命令行执行-config-rewrite-命令" class="header-anchor">#</a> 2）第二步，重启 redis 服务，进入命令行执行 <code>config rewrite</code> 命令</h4> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@VM-16-7-centos ~<span class="token punctuation">]</span><span class="token comment"># redis-cli -h 127.0.0.1 -p 6379</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> config rewrite
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>这时候可以看到 conf 文件的最后面自动新增了 <code>default</code> 用户的 ACL，如下所示：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>user default on nopass sanitize-payload ~* <span class="token operator">&amp;</span>* +@all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_3-在-conf-文件中注释-aclfile-的路径配置-默认是注释的"><a href="#_3-在-conf-文件中注释-aclfile-的路径配置-默认是注释的" class="header-anchor">#</a> 3）在 conf 文件中注释 aclfile 的路径配置（默认是注释的）</h4> <p>原因是因为两种配置方式（conf 方式和 aclfile 方式）是冲突的，只能开启一个。</p> <div class="language-bash line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br></div><pre class="language-bash"><code><span class="token comment"># Using an external ACL file</span>
<span class="token comment">#</span>
<span class="token comment"># Instead of configuring users here in this file, it is possible to use</span>
<span class="token comment"># a stand-alone file just listing users. The two methods cannot be mixed:</span>
<span class="token comment"># if you configure users here and at the same time you activate the external</span>
<span class="token comment"># ACL file, the server will refuse to start.</span>
<span class="token comment">#</span>
<span class="token comment"># The format of the external ACL user file is exactly the same as the</span>
<span class="token comment"># format that is used inside redis.conf to describe users.</span>
<span class="token comment">#</span>
<span class="token comment"># aclfile /etc/redis/users.acl</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="_4-重启-redis-服务来加载配置"><a href="#_4-重启-redis-服务来加载配置" class="header-anchor">#</a> 4）重启 Redis 服务来加载配置</h4> <p>加载配置需要重启 Redis 服务。</p> <h4 id="_5-查看新的-acl-list"><a href="#_5-查看新的-acl-list" class="header-anchor">#</a> 5）查看新的 acl list</h4> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@VM-16-7-centos ~<span class="token punctuation">]</span><span class="token comment"># redis-cli -h 127.0.0.1 -p 6379</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> acl list
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;user default on nopass sanitize-payload ~* &amp;* +@all&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>因此我们可以直接在 conf 配置文件中，使用类似上面 <code>default</code> 用户的这行 DSL 命令来设置用户权限，或者我们也可以配置外部 aclfile 配置权限</p> <h3 id="使用外部-aclfile-配置-acl"><a href="#使用外部-aclfile-配置-acl" class="header-anchor">#</a> 使用外部 aclfile 配置 ACL</h3> <blockquote><p>如果我们有较多的用户且希望有一个单独的配置文件时，可以使用这种方式</p></blockquote> <p>配置 aclfile 需要先将 conf 中配置的 DSL 注释掉或直接删除，因为 Redis 不允许两种 ACL 管理方式同时使用，否则在启动 Redis的时候会报下面的错误：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># Configuring Redis with users defined in redis.conf and at the same setting an ACL file path is invalid. This setup is very likely to lead to configuration errors and security holes, please define either an ACL file or declare users directly in your redis.conf, but not both.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>使用外部 aclfile 文件配置 <code>default</code> 和其他用户的 ACL 权限，操作步骤如下：</p> <h4 id="_1-第一步-注释-conf-文件中所有已授权的-acl-命令"><a href="#_1-第一步-注释-conf-文件中所有已授权的-acl-命令" class="header-anchor">#</a> 1）第一步，注释 conf 文件中所有已授权的 ACL 命令</h4> <p>如果先前是用 <code>config rewrite</code> 命令生成的 ACL 语句，那么它们一般是在 conf 文件最末尾，例如 <code>default</code> 用户的这行，把它注释掉：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># user default on nopass sanitize-payload ~* &amp;* +@all</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_2-第二步-在-conf-文件中配置外部-aclfile-路径"><a href="#_2-第二步-在-conf-文件中配置外部-aclfile-路径" class="header-anchor">#</a> 2）第二步，在 conf 文件中配置外部 aclfile 路径</h4> <ul><li>在 conf 文件中注释掉 <code>default</code> 用户的密码，因为开启 aclfile 之后，<code>requirepass</code> 的密码就失效了</li> <li>在 conf 文件中配置 aclfile 的路径，然后创建该文件，否则重启 Redis 服务会报错找不到该文件</li></ul> <div class="language-bash line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br></div><pre class="language-bash"><code><span class="token comment"># Using an external ACL file</span>
<span class="token comment">#</span>
<span class="token comment"># Instead of configuring users here in this file, it is possible to use</span>
<span class="token comment"># a stand-alone file just listing users. The two methods cannot be mixed:</span>
<span class="token comment"># if you configure users here and at the same time you activate the external</span>
<span class="token comment"># ACL file, the server will refuse to start.</span>
<span class="token comment">#</span>
<span class="token comment"># The format of the external ACL user file is exactly the same as the</span>
<span class="token comment"># format that is used inside redis.conf to describe users.</span>
<span class="token comment">#</span>
aclfile /usr/local/redis/acl/users.acl

<span class="token comment"># IMPORTANT NOTE: starting with Redis 6 &quot;requirepass&quot; is just a compatibility</span>
<span class="token comment"># layer on top of the new ACL system. The option effect will be just setting</span>
<span class="token comment"># the password for the default user. Clients will still authenticate using</span>
<span class="token comment"># AUTH &lt;password&gt; as usually, or more explicitly with AUTH default &lt;password&gt;</span>
<span class="token comment"># if they follow the new protocol: both will work.</span>
<span class="token comment">#</span>
<span class="token comment"># The requirepass is not compatible with aclfile option and the ACL LOAD</span>
<span class="token comment"># command, these will cause requirepass to be ignored.</span>
<span class="token comment">#</span>
<span class="token comment"># requirepass 123456</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>新建一个文件夹 <code>acl/</code>，然后新建一个文件 <code>users.acl</code>，将用户权限相关的配置（DSL 语法）拷贝到 <code>users.acl</code> 中：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> /usr/local/redis/
<span class="token function">mkdir</span> acl
<span class="token builtin class-name">cd</span> acl
<span class="token function">vim</span> users.acl
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>然后将信息写入到配置文件中：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>user default on nopass sanitize-payload ~* <span class="token operator">&amp;</span>* +@all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>上面这段 DSL 是从前面复制的，由<code>config rewrite</code> 命令生成的。也就是有最高权限的 <code>default</code> 用户</p> <h4 id="_3-第三步-重启-redis-服务来加载配置"><a href="#_3-第三步-重启-redis-服务来加载配置" class="header-anchor">#</a> 3）第三步，重启 Redis 服务来加载配置</h4> <p>加载配置需要重启 Redis 服务</p> <p>PS：经测试，首次将 conf 方式改为 aclfile 方式，必须要重启 Redis 服务才行（否则会报错 <code>(error) ERR This Redis instance is not configured to use an ACL file.（此处省略 100 字）</code>）</p> <p>而以后修改 <code>users.acl</code> 文件里面的 DSL 语句后，只需要在命令行执行 <code>acl load</code> 即可将将最新的 aclfile 中的权限加载至 Redis服务中）</p> <h4 id="_4-查看新的-acl-list"><a href="#_4-查看新的-acl-list" class="header-anchor">#</a> 4）查看新的 acl list</h4> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@VM-16-7-centos ~<span class="token punctuation">]</span><span class="token comment"># redis-cli -h 127.0.0.1 -p 6379</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> acl list
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;user default on nopass sanitize-payload ~* &amp;* +@all&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="对比-conf-和-aclfile-两种方式"><a href="#对比-conf-和-aclfile-两种方式" class="header-anchor">#</a> 对比 conf 和 aclfile 两种方式</h3> <p>在 conf 和 aclfile 两种方式中配置 DSL，官方更推荐使用 aclfile，因为如果在 conf 中配置了权限之后需要重启 redis 服务才能将配置的权限加载至 Redis 服务中来，但如果使用 aclfile 模式，可以调用 <code>acl load</code> 命令将 aclfile 中配置的 ACL 权限热加载进环境中，类似于 MySQL 中的 <code>flush privileges</code></p> <p><svg id="SvgjsSvg1006" width="611" height="235" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs"><defs id="SvgjsDefs1007"></defs><g id="SvgjsG1008" transform="translate(25,67)"><path id="SvgjsPath1009" d="M0 0L165.9999 0L165.9999 35.75 L0 35.75Z" stroke="rgba(201,208,227,1)" stroke-width="1" fill-opacity="1" fill="#f5f7fb"></path><path id="SvgjsPath1010" d="M165.9999 0L373.96259999999995 0L373.96259999999995 35.75 L165.9999 35.75Z" stroke="rgba(201,208,227,1)" stroke-width="1" fill-opacity="1" fill="#f5f7fb"></path><path id="SvgjsPath1011" d="M373.9626 0L561 0L561 35.75 L373.9626 35.75Z" stroke="rgba(201,208,227,1)" stroke-width="1" fill-opacity="1" fill="#f5f7fb"></path><path id="SvgjsPath1012" d="M0 35.75L165.9999 35.75L165.9999 71.5 L0 71.5Z" stroke="rgba(201,208,227,1)" stroke-width="1" fill-opacity="1" fill="#ffffff"></path><path id="SvgjsPath1013" d="M165.9999 35.75L373.96259999999995 35.75L373.96259999999995 71.5 L165.9999 71.5Z" stroke="rgba(201,208,227,1)" stroke-width="1" fill-opacity="1" fill="#ffffff"></path><path id="SvgjsPath1014" d="M373.9626 35.75L561 35.75L561 71.5 L373.9626 71.5Z" stroke="rgba(201,208,227,1)" stroke-width="1" fill-opacity="1" fill="#ffffff"></path><path id="SvgjsPath1015" d="M0 71.5L165.9999 71.5L165.9999 107.25 L0 107.25Z" stroke="rgba(201,208,227,1)" stroke-width="1" fill-opacity="1" fill="#ffffff"></path><path id="SvgjsPath1016" d="M165.9999 71.5L373.96259999999995 71.5L373.96259999999995 107.25 L165.9999 107.25Z" stroke="rgba(201,208,227,1)" stroke-width="1" fill-opacity="1" fill="#ffffff"></path><path id="SvgjsPath1017" d="M373.9626 71.5L561 71.5L561 107.25 L373.9626 107.25Z" stroke="rgba(201,208,227,1)" stroke-width="1" fill-opacity="1" fill="#ffffff"></path><path id="SvgjsPath1018" d="M0 107.25L165.9999 107.25L165.9999 143 L0 143Z" stroke="rgba(201,208,227,1)" stroke-width="1" fill-opacity="1" fill="#ffffff"></path><path id="SvgjsPath1019" d="M165.9999 107.25L373.96259999999995 107.25L373.96259999999995 143 L165.9999 143Z" stroke="rgba(201,208,227,1)" stroke-width="1" fill-opacity="1" fill="#ffffff"></path><path id="SvgjsPath1020" d="M373.9626 107.25L561 107.25L561 143 L373.9626 143Z" stroke="rgba(201,208,227,1)" stroke-width="1" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1021"><text id="SvgjsText1022" font-family="微软雅黑" text-anchor="start" font-size="16px" width="166px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="3.875" transform="rotate(0)"></text></g><g id="SvgjsG1023"><text id="SvgjsText1024" font-family="微软雅黑" text-anchor="start" font-size="16px" width="208px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="3.875" transform="rotate(0)"><tspan id="SvgjsTspan1025" dy="20" x="165.9999"><tspan id="SvgjsTspan1026">  redis.conf</tspan></tspan></text></g><g id="SvgjsG1027"><text id="SvgjsText1028" font-family="微软雅黑" text-anchor="start" font-size="16px" width="188px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="3.875" transform="rotate(0)"><tspan id="SvgjsTspan1029" dy="20" x="373.9626"><tspan id="SvgjsTspan1030">  users.acl</tspan></tspan></text></g><g id="SvgjsG1031"><text id="SvgjsText1032" font-family="微软雅黑" text-anchor="start" font-size="16px" width="166px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="39.625" transform="rotate(0)"><tspan id="SvgjsTspan1033" dy="20" x="0"><tspan id="SvgjsTspan1034">  配置方式</tspan></tspan></text></g><g id="SvgjsG1035"><text id="SvgjsText1036" font-family="微软雅黑" text-anchor="start" font-size="16px" width="208px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="39.625" transform="rotate(0)"><tspan id="SvgjsTspan1037" dy="20" x="165.9999"><tspan id="SvgjsTspan1038">  DSL</tspan></tspan></text></g><g id="SvgjsG1039"><text id="SvgjsText1040" font-family="微软雅黑" text-anchor="start" font-size="16px" width="188px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="39.625" transform="rotate(0)"><tspan id="SvgjsTspan1041" dy="20" x="373.9626"><tspan id="SvgjsTspan1042">  DSL</tspan></tspan></text></g><g id="SvgjsG1043"><text id="SvgjsText1044" font-family="微软雅黑" text-anchor="start" font-size="16px" width="166px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="75.375" transform="rotate(0)"><tspan id="SvgjsTspan1045" dy="20" x="0"><tspan id="SvgjsTspan1046">  加载 ACL 配置</tspan></tspan></text></g><g id="SvgjsG1047"><text id="SvgjsText1048" font-family="微软雅黑" text-anchor="start" font-size="16px" width="208px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="75.375" transform="rotate(0)"><tspan id="SvgjsTspan1049" dy="20" x="165.9999"><tspan id="SvgjsTspan1050">  重启 Redis 服务</tspan></tspan></text></g><g id="SvgjsG1051"><text id="SvgjsText1052" font-family="微软雅黑" text-anchor="start" font-size="16px" width="188px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="75.375" transform="rotate(0)"><tspan id="SvgjsTspan1053" dy="20" x="373.9626"><tspan id="SvgjsTspan1054">  ACL LOAD 命令</tspan></tspan></text></g><g id="SvgjsG1055"><text id="SvgjsText1056" font-family="微软雅黑" text-anchor="start" font-size="16px" width="166px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="111.125" transform="rotate(0)"><tspan id="SvgjsTspan1057" dy="20" x="0"><tspan id="SvgjsTspan1058">  持久化 ACL 配置</tspan></tspan></text></g><g id="SvgjsG1059"><text id="SvgjsText1060" font-family="微软雅黑" text-anchor="start" font-size="16px" width="208px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="111.125" transform="rotate(0)"><tspan id="SvgjsTspan1061" dy="20" x="165.9999"><tspan id="SvgjsTspan1062">  CONFIG REWRITE 命令</tspan></tspan></text></g><g id="SvgjsG1063"><text id="SvgjsText1064" font-family="微软雅黑" text-anchor="start" font-size="16px" width="188px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="111.125" transform="rotate(0)"><tspan id="SvgjsTspan1065" dy="20" x="373.9626"><tspan id="SvgjsTspan1066">  ACL SAVE 命令</tspan></tspan></text></g></g><g id="SvgjsG1067" transform="translate(168,25)"><path id="SvgjsPath1068" d="M 0 0L 250 0L 250 39L 0 39Z" stroke="none" fill="none"></path><g id="SvgjsG1069"><text id="SvgjsText1070" font-family="微软雅黑" text-anchor="middle" font-size="16px" width="250px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="16px" weight="400" font-style="" opacity="1" y="5.5" transform="rotate(0)"><tspan id="SvgjsTspan1071" dy="20" x="125"><tspan id="SvgjsTspan1072">对比 conf 和 aclfile 两种方式</tspan></tspan></text></g></g></svg></p> <h2 id="通过命令行来管理用户"><a href="#通过命令行来管理用户" class="header-anchor">#</a> 通过命令行来管理用户</h2> <p>上面可以看到，我们在安装好 Redis 后，需要通过编辑文件来选择使用哪种 ACL 模式（conf 还是外部 aclfile）。并且我们知道无论哪种方式，里面都是存一些 DSL 语句，那么自然我们可以直接在配置文件中配置各用户的 ACL 权限，但每次编辑完后都需要执行 <code>ACL LOAD</code> 或者重启 Redis 服务才能生效</p> <p>事实上我们可以直接在命令行下配置 ACL，<strong>在命令行模式下配置的权限无需重启服务即可生效</strong></p> <p>只是我们在命令行模式下配置 ACL 后，必须要将其持久化到 aclfile 或者 conf 文件中，因为只有将权限持久化，下次重启才会自动加载该权限，<strong>如果忘记持久化，一旦服务宕机或重启，该权限就会丢失</strong></p> <h3 id="持久化的方式"><a href="#持久化的方式" class="header-anchor">#</a> 持久化的方式</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 如果使用 conf 模式，将 ACL 权限持久化到 redis.conf 文件中使用下面的命令：</span>
config rewrite

<span class="token comment"># 如果使用 aclfile 模式，将 ACL 权限持久化到 users.acl 文件中使用下面的命令：</span>
acl save
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>下面看如何使用命令来创建、编辑用户以及它们的 ACL。</p> <h3 id="增删改查用户"><a href="#增删改查用户" class="header-anchor">#</a> 增删改查用户</h3> <h4 id="_1-创建和修改用户"><a href="#_1-创建和修改用户" class="header-anchor">#</a> 1）创建和修改用户</h4> <p>使用 <a href="https://redis.io/commands/acl-setuser/" target="_blank" rel="noopener noreferrer"><code>ACL SETUSER</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 命令来创建和编辑用户 ACL</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># username 区分大小写 </span>
<span class="token comment"># 若用户不存在，则按默认规则创建用户，并为其增加 &lt;rules&gt;。若用户存在则在已有规则上增加 &lt;rules&gt;</span>
ACL SETUSER <span class="token operator">&lt;</span>username<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>rules<span class="token operator">&gt;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>默认规则下新增的用户处于非活跃状态，且没有密码，同时也没有任何命令和 key 的权限：</p> <div class="language-bash {1, 5} line-numbers-mode"><pre class="language-bash"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> acl setuser zhangsan
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> acl list
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;user default on nopass sanitize-payload ~* &amp;* +@all&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;user zhangsan off resetchannels -@all&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>所以我们可以在新增用户时，指定一些规则，包含密码和权限等：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 创建 lisi 用户，on 为活跃状态，密码为 123456，允许对所有 demo 开头的 key 使用 get 和 set 命令</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> acl setuser lisi on <span class="token operator">&gt;</span><span class="token number">123456</span> ~demo* +get +set

<span class="token comment"># 让之前创建的 zhangsan 用户可用，并给它新增一个密码 123456</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> acl setuser zhangsan on <span class="token operator">&gt;</span><span class="token number">123456</span>

<span class="token comment"># 为 zhangsan 用户新增 list 类别下所有命令的权限</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> acl setuser zhangsan on +@list
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>查看现在的 <code>acl list</code>，可以发现密码都是一个 sha256 码的字符串，不是明文存储，还是比较安全的：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> acl list
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;user default on nopass sanitize-payload ~* &amp;* +@all&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;user lisi on #8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92 ~demo* resetchannels -@all +get +set&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;user zhangsan on #8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92 resetchannels -@all +@list&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>需要注意的是，多次调用 <code>SETUSER</code> 不会重置用户，而只会将 ACL 规则应用于现有用户。什么意思呢？</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> acl setuser zhangsan +get
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> acl setuser zhangsan +set
OK
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>以上两次调用 <code>SETUSER</code> 将导致 <code>zhangsan</code> 这个用户能够调用 <a href="https://redis.io/commands/get/" target="_blank" rel="noopener noreferrer"><code>GET</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 和 <a href="https://redis.io/commands/set/" target="_blank" rel="noopener noreferrer"><code>SET</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h4 id="_2-查询用户"><a href="#_2-查询用户" class="header-anchor">#</a> 2）查询用户</h4> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 查看所有用户名</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> acl <span class="token function">users</span>

<span class="token comment"># 查看所有用户的 acl 信息</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> acl list

<span class="token comment"># 查看当前登录的用户名</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> acl <span class="token function">whoami</span>

<span class="token comment"># 查看指定用户的 ACL 权限</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> acl getuser <span class="token operator">&lt;</span>username<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="_3-删除用户"><a href="#_3-删除用户" class="header-anchor">#</a> 3）删除用户</h4> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 删除指定用户</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> acl deluser <span class="token operator">&lt;</span>username<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="登录和切换指定用户"><a href="#登录和切换指定用户" class="header-anchor">#</a> 登录和切换指定用户</h3> <h4 id="_1-登录指定用户"><a href="#_1-登录指定用户" class="header-anchor">#</a> 1）登录指定用户</h4> <p>对于用 ACL 管理的用户，需要使用 <code>redis-cli --user xxx --pass yyy</code> 来登陆：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@VM-16-7-centos ~<span class="token punctuation">]</span><span class="token comment"># redis-cli -h 127.0.0.1 -p 6379 --user lisi --pass 123456</span>
Warning: Using a password with <span class="token string">'-a'</span> or <span class="token string">'-u'</span> option on the <span class="token builtin class-name">command</span> line interface may not be safe.
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> acl <span class="token function">whoami</span>
<span class="token punctuation">(</span>error<span class="token punctuation">)</span> NOPERM this user has no permissions to run the <span class="token string">'acl|whoami'</span> <span class="token builtin class-name">command</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>

<span class="token punctuation">[</span>root@VM-16-7-centos ~<span class="token punctuation">]</span><span class="token comment"># redis-cli -h 127.0.0.1 -p 6379 --user wangwu --pass 123456</span>
Warning: Using a password with <span class="token string">'-a'</span> or <span class="token string">'-u'</span> option on the <span class="token builtin class-name">command</span> line interface may not be safe.
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> acl <span class="token function">whoami</span>
<span class="token string">&quot;wangwu&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="_2-切换到指定用户"><a href="#_2-切换到指定用户" class="header-anchor">#</a> 2）切换到指定用户</h4> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 使用 auth 命令切换用户</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> auth <span class="token operator">&lt;</span>username<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>password<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="热加载命令"><a href="#热加载命令" class="header-anchor">#</a> 热加载命令</h3> <p>如果直接在 aclfile 中修改或新增 ACL 权限，修改之后不会立刻生效，需要执行如下命令将配置热加载至 Redis 服务中</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> acl load
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="持久化命令"><a href="#持久化命令" class="header-anchor">#</a> 持久化命令</h3> <p>如果是通过命令行修改或新增 ACL 权限，需要将其持久化到配置文件中，否则在重启 Redis 服务后，这些 ACL 权限就会丢失</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 如果使用的是 aclfile 方式，将 ACL 权限持久化到磁盘的 aclfile 中</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> acl save

<span class="token comment"># 如果使用的是 conf 方式，将 ACL 权限持久化到 redis.conf 中</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> config rewrite
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="查看命令类别-用于授权"><a href="#查看命令类别-用于授权" class="header-anchor">#</a> 查看命令类别，用于授权</h3> <p>命令类别的出现就是为了方便我们定义用户权限。因为如果通过一个接一个地指定所有命令来设置用户 ACL 确实很烦人，所以我们这样做：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 通过 +@all 和 -@dangerous，我们包含了所有命令，然后在 Redis 命令表中删除了所有标记为危险的命令</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> acl setuser zhangsan on +@all -@dangerous <span class="token operator">&gt;</span><span class="token number">123456</span><span class="token punctuation">..</span>. ~*
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>那么有哪些命令类别可供选择呢？可以用如下命令进行查看：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># acl cat 显示所有的命令类别</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> acl <span class="token function">cat</span>
 <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;keyspace&quot;</span>
 <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;read&quot;</span>
 <span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;write&quot;</span>
 <span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;set&quot;</span>
 <span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">&quot;sortedset&quot;</span>
 <span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">&quot;list&quot;</span>
 <span class="token number">7</span><span class="token punctuation">)</span> <span class="token string">&quot;hash&quot;</span>
 <span class="token number">8</span><span class="token punctuation">)</span> <span class="token string">&quot;string&quot;</span>
 <span class="token number">9</span><span class="token punctuation">)</span> <span class="token string">&quot;bitmap&quot;</span>
<span class="token number">10</span><span class="token punctuation">)</span> <span class="token string">&quot;hyperloglog&quot;</span>
<span class="token number">11</span><span class="token punctuation">)</span> <span class="token string">&quot;geo&quot;</span>
<span class="token number">12</span><span class="token punctuation">)</span> <span class="token string">&quot;stream&quot;</span>
<span class="token number">13</span><span class="token punctuation">)</span> <span class="token string">&quot;pubsub&quot;</span>
<span class="token number">14</span><span class="token punctuation">)</span> <span class="token string">&quot;admin&quot;</span>
<span class="token number">15</span><span class="token punctuation">)</span> <span class="token string">&quot;fast&quot;</span>
<span class="token number">16</span><span class="token punctuation">)</span> <span class="token string">&quot;slow&quot;</span>
<span class="token number">17</span><span class="token punctuation">)</span> <span class="token string">&quot;blocking&quot;</span>
<span class="token number">18</span><span class="token punctuation">)</span> <span class="token string">&quot;dangerous&quot;</span>
<span class="token number">19</span><span class="token punctuation">)</span> <span class="token string">&quot;connection&quot;</span>
<span class="token number">20</span><span class="token punctuation">)</span> <span class="token string">&quot;transaction&quot;</span>
<span class="token number">21</span><span class="token punctuation">)</span> <span class="token string">&quot;scripting&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>每一个命令类别具体包含了哪些命令呢？可以用如下命令进行查看：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># acl cat &lt;category&gt; 显示指定类别下的所有命令</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> acl <span class="token function">cat</span> list
 <span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;rpushx&quot;</span>
 <span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;lrange&quot;</span>
 <span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;lindex&quot;</span>
 <span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;blpop&quot;</span>
 <span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">&quot;lpop&quot;</span>
 <span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">&quot;brpoplpush&quot;</span>
 <span class="token number">7</span><span class="token punctuation">)</span> <span class="token string">&quot;lset&quot;</span>
 <span class="token number">8</span><span class="token punctuation">)</span> <span class="token string">&quot;rpoplpush&quot;</span>
 <span class="token number">9</span><span class="token punctuation">)</span> <span class="token string">&quot;lpos&quot;</span>
<span class="token number">10</span><span class="token punctuation">)</span> <span class="token string">&quot;lrem&quot;</span>
<span class="token number">11</span><span class="token punctuation">)</span> <span class="token string">&quot;lpushx&quot;</span>
<span class="token number">12</span><span class="token punctuation">)</span> <span class="token string">&quot;llen&quot;</span>
<span class="token number">13</span><span class="token punctuation">)</span> <span class="token string">&quot;blmove&quot;</span>
<span class="token number">14</span><span class="token punctuation">)</span> <span class="token string">&quot;brpop&quot;</span>
<span class="token number">15</span><span class="token punctuation">)</span> <span class="token string">&quot;sort&quot;</span>
<span class="token number">16</span><span class="token punctuation">)</span> <span class="token string">&quot;rpop&quot;</span>
<span class="token number">17</span><span class="token punctuation">)</span> <span class="token string">&quot;ltrim&quot;</span>
<span class="token number">18</span><span class="token punctuation">)</span> <span class="token string">&quot;sort_ro&quot;</span>
<span class="token number">19</span><span class="token punctuation">)</span> <span class="token string">&quot;rpush&quot;</span>
<span class="token number">20</span><span class="token punctuation">)</span> <span class="token string">&quot;blmpop&quot;</span>
<span class="token number">21</span><span class="token punctuation">)</span> <span class="token string">&quot;lmove&quot;</span>
<span class="token number">22</span><span class="token punctuation">)</span> <span class="token string">&quot;lmpop&quot;</span>
<span class="token number">23</span><span class="token punctuation">)</span> <span class="token string">&quot;lpush&quot;</span>
<span class="token number">24</span><span class="token punctuation">)</span> <span class="token string">&quot;linsert&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h3 id="其他常用-acl-命令"><a href="#其他常用-acl-命令" class="header-anchor">#</a> 其他常用 ACL 命令</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 查看 ACL 安全日志</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> acl log

<span class="token comment"># 查看 help 文档</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> acl <span class="token builtin class-name">help</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="acl-规则"><a href="#acl-规则" class="header-anchor">#</a> ACL 规则</h2> <p>前面大量介绍了 ACL 的一些命令，ACL 是使用 DSL（Domain specific language）定义的，一个 DSL 中最核心也是最难记忆的就是规则的写法</p> <p>以下是整理的一些 ACL 规则的列表，某些规则只是一个单词，用于激活或删除标志或对用户 ACL 执行更改。其他规则是与命令或类别名称、键模式等、关联的字符前缀</p> <h3 id="启用和禁用用户"><a href="#启用和禁用用户" class="header-anchor">#</a> 启用和禁用用户</h3> <ul><li><code>on</code>：启用用户，可以以该用户身份进行认证</li> <li><code>off</code>：禁用用户，不再可以使用此用户进行身份验证，但是已经通过身份验证的连接仍然可以使用</li></ul> <h3 id="允许和禁止调用命令"><a href="#允许和禁止调用命令" class="header-anchor">#</a> 允许和禁止调用命令</h3> <ul><li><code>+&lt;command&gt;</code>：将命令添加到用户可以调用的命令列表中</li> <li><code>-&lt;command&gt;</code>：将命令从用户可以调用的命令列表中移除</li> <li><code>+@&lt;category&gt;</code>：允许用户调用 <code>&lt;category&gt;</code> 类别中的所有命令，有效类别为 <code>@admin</code>，<code>@set</code>，<code>@sortedset</code> 等，可通过调用 <a href="https://redis.io/commands/acl-cat/" target="_blank" rel="noopener noreferrer"><code>ACL CAT</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 命令查看完整列表。特殊类别 <code>@all</code> 表示所有命令，包括当前和未来版本中存在的所有命令</li> <li><code>-@&lt;category&gt;</code>：禁止用户调用 <code>&lt;category&gt;</code> 类别中的所有命令</li> <li><code>+&lt;command&gt;|subcommand</code>：允许使用已禁用命令的特定子命令</li> <li><code>allcommands</code>：<code>+@all</code> 的别名，包括当前存在的命令以及将来通过模块加载的所有命令</li> <li><code>nocommands</code>：<code>-@all</code> 的别名，禁止调用所有命令</li></ul> <h3 id="允许和禁止访问某些-key"><a href="#允许和禁止访问某些-key" class="header-anchor">#</a> 允许和禁止访问某些 Key</h3> <ul><li><code>~&lt;pattern&gt;</code>：添加可以在命令中提及的键模式。例如 <code>~*</code> 允许所有键</li> <li><code>allkeys</code>：<code>~*</code> 的别名</li> <li><code>resetkeys</code>：刷新允许的键模式列表。例如 ACL <code>~foo:* ~bar:* resetkeys ~objects:*</code>，将导致客户端只能访问与模式 <code>objects:*</code> 匹配的键</li></ul> <h3 id="为用户配置有效密码"><a href="#为用户配置有效密码" class="header-anchor">#</a> 为用户配置有效密码</h3> <ul><li><code>&gt;&lt;password&gt;</code>：将此密码添加到用户的有效密码列表中。例如，<code>&gt;mypass</code>将 <code>mypass</code> 添加到有效密码列表中。该命令会清除用户的 <code>nopass</code> 标记。每个用户可以有任意数量的有效密码</li> <li><code>&lt;&lt;password&gt;</code>：从有效密码列表中删除此密码。若该用户的有效密码列表中没有此密码则会返回错误信息。</li> <li><code>#&lt;hash&gt;</code>：将此 SHA-256 哈希值添加到用户的有效密码列表中。该哈希值将与为 ACL 用户输入的密码的哈希值进行比较。允许用户将哈希存储在 users.acl 文件中，而不是存储明文密码。仅接受 SHA-256 哈希值，因为密码哈希必须为 64 个字符且小写的十六进制字符</li> <li><code>!&lt;hash&gt;</code>：从有效密码列表中删除该哈希值。当不知道哈希值对应的明文是什么时很有用</li> <li><code>nopass</code>：移除该用户已设置的所有密码，并将该用户标记为 <code>nopass</code> 无密码状态：任何密码都可以登录。<code>resetpass</code> 命令可以清除 <code>nopass</code> 这种状态</li> <li><code>resetpass</code>：清空该用户的所有密码列表，而且移除 <code>nopass</code> 状态。<code>resetpass</code> 之后用户没有关联的密码同时也无法使用无密码登录，因此 <code>resetpass</code> 之后必须添加密码或改为 <code>nopass</code> 状态才能正常登录</li> <li><code>reset</code>：重置用户状态为初始状态。执行以下操作 <code>resetpass</code>，<code>resetkeys</code>，<code>off</code>，<code>-@all</code></li></ul> <h2 id="参考文档"><a href="#参考文档" class="header-anchor">#</a> 参考文档</h2> <ul><li><a href="https://redis.io/docs/manual/security/acl/" target="_blank" rel="noopener noreferrer">官方文档 - ACL<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>（完）</p></div> <!----> <div class="content__content-bottom"></div> <footer class="page-meta"><div class="edit-link"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon edit-icon"><path d="M117.953 696.992 64.306 959.696l265.931-49.336 450.204-452.505-212.284-213.376-450.204 452.513zm496.384-296.326L219.039 797.993l-46.108-46.34L568.233 354.33l46.104 46.335zm345.357-122.99-114.45 115.04-212.288-213.377 114.45-115.035 212.288 213.371zm0 0" fill="currentColor"></path></svg> <a href="https://github.com/xuefengji/blog/edit/main/docs/databases/redis/access-control-list.md" target="_blank" rel="noopener noreferrer">编辑此页</a></div> <div class="meta-item update-time"><span class="label">上次编辑于:</span> <span class="info">2022年9月26日 20:16</span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/databases/redis/cache/" class="prev"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon prev-icon"><path d="M906.783 588.79c-.02 8.499-6.882 15.36-15.38 15.37l-443.7-.01 75.704 191.682c2.52 6.42.482 13.763-5.038 17.91-5.52 4.168-13.138 4.147-18.616-.092L123.228 524.175a15.362 15.362 0 0 1-6-12.165c0-4.782 2.222-9.277 6-12.185L499.753 210.35a15.388 15.388 0 0 1 9.38-3.195c3.236 0 6.502 1.034 9.236 3.103 5.52 4.147 7.578 11.49 5.038 17.91L447.683 419.84l443.72-.01c8.498.01 15.36 6.881 15.36 15.36l.02 153.6z" fill="currentColor"></path></svg>
        Redis 缓存三大问题
      </a></span> <!----></p></div> <!----> <!----> <div class="content__page-bottom"></div></main> <!----></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.b7806c63.js" defer></script><script src="/assets/js/vendors~layout-Layout.38a14c95.js" defer></script><script src="/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound.c1742524.js" defer></script><script src="/assets/js/page-Redis的ACL安全策略.607ab741.js" defer></script>
  </body>
</html>
